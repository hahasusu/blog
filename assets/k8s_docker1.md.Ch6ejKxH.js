import{_ as s,c as n,o as a,a4 as l}from"./chunks/framework.GYzjcnJh.js";const u=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"k8s/docker1.md","filePath":"k8s/docker1.md"}'),p={name:"k8s/docker1.md"},e=l(`<h2 id="_1-dockerfile-如何封装一个tomcat镜像-并实战下-并谈谈" tabindex="-1">1 dockerfile 如何封装一个tomcat镜像？并实战下 并谈谈 <a class="header-anchor" href="#_1-dockerfile-如何封装一个tomcat镜像-并实战下-并谈谈" aria-label="Permalink to &quot;1  dockerfile 如何封装一个tomcat镜像？并实战下  并谈谈&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;"># 使用官方的 OpenJDK 作为基础镜像</span></span>
<span class="line"><span style="color:#E2931D;">FROM</span><span style="color:#91B859;"> openjdk:11-jre-slim</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">LABEL</span><span style="color:#91B859;"> maintainer</span><span style="color:#91B859;"> luozaibo</span><span style="color:#39ADB5;"> &lt;</span><span style="color:#91B859;">zaiboluo@gmail.co</span><span style="color:#90A4AE;">m</span><span style="color:#39ADB5;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 设置 Tomcat 版本和安装目录</span></span>
<span class="line"><span style="color:#E2931D;">ADD</span><span style="color:#91B859;"> apache-tomcat-9.0.89.tar.gz</span><span style="color:#91B859;"> /usr/local</span></span>
<span class="line"><span style="color:#E2931D;">ENV</span><span style="color:#91B859;"> TOMCAT_HOME</span><span style="color:#91B859;"> /usr/local/apache-tomcat-9.0.89</span></span>
<span class="line"><span style="color:#E2931D;">ENV</span><span style="color:#91B859;"> PATH</span><span style="color:#90A4AE;"> $TOMCAT_HOME</span><span style="color:#91B859;">/bin:</span><span style="color:#90A4AE;">$PATH</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">WORKDIR</span><span style="color:#90A4AE;"> $TOMCAT_HOME</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">#RUN rm -rf webapps/ROOT</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">#ADD *.war webapps/ROOT.war</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 暴露 Tomcat 的默认端口</span></span>
<span class="line"><span style="color:#E2931D;">EXPOSE</span><span style="color:#F76D47;"> 8080</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 设置容器启动时执行的命令</span></span>
<span class="line"><span style="color:#E2931D;">CMD</span><span style="color:#90A4AE;"> [</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">catalina.sh</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;">, </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">run</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">]</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br></div></div><h2 id="_2把现在生产服务器运行的java-项目-迁移到容器-实战演练下-工作会用到" tabindex="-1">2把现在生产服务器运行的java 项目 迁移到容器，实战演练下 工作会用到 <a class="header-anchor" href="#_2把现在生产服务器运行的java-项目-迁移到容器-实战演练下-工作会用到" aria-label="Permalink to &quot;2把现在生产服务器运行的java 项目 迁移到容器，实战演练下  工作会用到&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;"># 使用官方的 OpenJDK 作为基础镜像</span></span>
<span class="line"><span style="color:#E2931D;">FROM</span><span style="color:#91B859;"> openjdk:11-jre-slim</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">LABEL</span><span style="color:#91B859;"> maintainer=</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">zaiboluo@gmail.com</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 设置 Tomcat 版本和安装目录</span></span>
<span class="line"><span style="color:#E2931D;">ADD</span><span style="color:#91B859;"> apache-tomcat-9.0.89.tar.gz</span><span style="color:#91B859;"> /usr/local</span></span>
<span class="line"><span style="color:#E2931D;">ENV</span><span style="color:#91B859;"> TOMCAT_HOME</span><span style="color:#91B859;"> /usr/local/apache-tomcat-9.0.89</span></span>
<span class="line"><span style="color:#E2931D;">ENV</span><span style="color:#91B859;"> PATH=</span><span style="color:#90A4AE;">$TOMCAT_HOME</span><span style="color:#91B859;">/bin:</span><span style="color:#90A4AE;">$PATH</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">RUN</span><span style="color:#91B859;"> rm</span><span style="color:#91B859;"> -rf</span><span style="color:#90A4AE;"> $TOMCAT_HOME</span><span style="color:#91B859;">/webapps/ROOT</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">ADD</span><span style="color:#91B859;"> ROOT.war</span><span style="color:#90A4AE;"> $TOMCAT_HOME</span><span style="color:#91B859;">/webapps</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 暴露 Tomcat 的默认端口</span></span>
<span class="line"><span style="color:#E2931D;">EXPOSE</span><span style="color:#F76D47;"> 8080</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 设置容器启动时执行的命令</span></span>
<span class="line"><span style="color:#E2931D;">CMD</span><span style="color:#91B859;"> catalina.sh</span><span style="color:#91B859;"> run</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><h2 id="_3-把docker日常命令总结下" tabindex="-1">3 把docker日常命令总结下： <a class="header-anchor" href="#_3-把docker日常命令总结下" aria-label="Permalink to &quot;3 把docker日常命令总结下：&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#E2931D;">docker</span><span style="color:#91B859;"> pull</span><span style="color:#39ADB5;"> &lt;</span><span style="color:#91B859;">image_nam</span><span style="color:#90A4AE;">e</span><span style="color:#39ADB5;">&gt;</span><span style="color:#91B859;">:</span><span style="color:#39ADB5;">&lt;</span><span style="color:#91B859;">ta</span><span style="color:#90A4AE;">g</span><span style="color:#39ADB5;">&gt;</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 示例</span></span>
<span class="line"><span style="color:#E2931D;">docker</span><span style="color:#91B859;"> pull</span><span style="color:#91B859;"> nginx:latest</span><span style="color:#90A4AE;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">docker</span><span style="color:#91B859;"> images</span></span>
<span class="line"><span style="color:#E2931D;">docker</span><span style="color:#91B859;"> rmi</span><span style="color:#39ADB5;"> &lt;</span><span style="color:#91B859;">image_i</span><span style="color:#90A4AE;">d</span><span style="color:#39ADB5;">&gt;</span></span>
<span class="line"><span style="color:#E2931D;">docker</span><span style="color:#91B859;"> build</span><span style="color:#91B859;"> -t</span><span style="color:#39ADB5;"> &lt;</span><span style="color:#91B859;">image_nam</span><span style="color:#90A4AE;">e</span><span style="color:#39ADB5;">&gt;</span><span style="color:#91B859;">:</span><span style="color:#39ADB5;">&lt;</span><span style="color:#91B859;">ta</span><span style="color:#90A4AE;">g</span><span style="color:#39ADB5;">&gt;</span><span style="color:#39ADB5;"> &lt;</span><span style="color:#91B859;">path_to_dockerfil</span><span style="color:#90A4AE;">e</span><span style="color:#39ADB5;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 创建并启动容器</span></span>
<span class="line"><span style="color:#E2931D;">docker</span><span style="color:#91B859;"> run</span><span style="color:#91B859;"> -d</span><span style="color:#91B859;"> --name</span><span style="color:#39ADB5;"> &lt;</span><span style="color:#91B859;">container_nam</span><span style="color:#90A4AE;">e</span><span style="color:#39ADB5;">&gt;</span><span style="color:#91B859;"> -p</span><span style="color:#39ADB5;"> &lt;</span><span style="color:#91B859;">host_por</span><span style="color:#90A4AE;">t</span><span style="color:#39ADB5;">&gt;</span><span style="color:#91B859;">:</span><span style="color:#39ADB5;">&lt;</span><span style="color:#91B859;">container_por</span><span style="color:#90A4AE;">t</span><span style="color:#39ADB5;">&gt;</span><span style="color:#39ADB5;"> &lt;</span><span style="color:#91B859;">image_nam</span><span style="color:#90A4AE;">e</span><span style="color:#39ADB5;">&gt;</span><span style="color:#91B859;">:</span><span style="color:#39ADB5;">&lt;</span><span style="color:#91B859;">ta</span><span style="color:#90A4AE;">g</span><span style="color:#39ADB5;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 列出运行中的容器</span></span>
<span class="line"><span style="color:#E2931D;">docker</span><span style="color:#91B859;"> ps</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 列出所有容器</span></span>
<span class="line"><span style="color:#E2931D;">docker</span><span style="color:#91B859;"> ps</span><span style="color:#91B859;"> -a</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 停止容器</span></span>
<span class="line"><span style="color:#E2931D;">docker</span><span style="color:#91B859;"> stop</span><span style="color:#39ADB5;"> &lt;</span><span style="color:#91B859;">container_i</span><span style="color:#90A4AE;">d</span><span style="color:#39ADB5;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 查看容器日志</span></span>
<span class="line"><span style="color:#E2931D;">docker</span><span style="color:#91B859;"> logs</span><span style="color:#39ADB5;"> &lt;</span><span style="color:#91B859;">conainer_i</span><span style="color:#90A4AE;">d</span><span style="color:#39ADB5;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 进入运行中的容器</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br></div></div><h2 id="谈谈-项目迁移到-容器-说下过程" tabindex="-1">谈谈 项目迁移到 容器 说下过程 <a class="header-anchor" href="#谈谈-项目迁移到-容器-说下过程" aria-label="Permalink to &quot;谈谈 项目迁移到 容器 说下过程&quot;">​</a></h2><p>#--------------服务器迁移实施文档--------------#</p><ol><li>（1）项目访问正常，编写dockerfile文件，封装成tomcat镜像，设置名字和打标，测试是否能正常打开</li><li>（2）登录本地仓库，push刚刚制作的tomcat镜像到仓库</li><li>（3）访问正常，nginx代理上新增的tomcat镜像容器服务器，然后重载nginx配置文件 ,看看是否打开正常</li><li>（4）如果没问题，项目迁移到容器迁移完成</li></ol>`,9),o=[e];function c(r,t,i,y,b,A){return a(),n("div",null,o)}const B=s(p,[["render",c]]);export{u as __pageData,B as default};
