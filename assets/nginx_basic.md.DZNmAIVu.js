import{_ as s,c as n,o as a,a4 as l}from"./chunks/framework.GYzjcnJh.js";const m=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"nginx/basic.md","filePath":"backend/nginx/basic.md"}'),p={name:"nginx/basic.md"},e=l(`<div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#E2931D;">nginx</span><span style="color:#91B859;"> -s</span><span style="color:#91B859;"> stop</span><span style="color:#91B859;">       快速关闭Nginx，可能不保存相关信息，并迅速终止web服务。</span></span>
<span class="line"><span style="color:#E2931D;">nginx</span><span style="color:#91B859;"> -s</span><span style="color:#91B859;"> quit</span><span style="color:#91B859;">       平稳关闭Nginx，保存相关信息，有安排的结束web服务。</span></span>
<span class="line"><span style="color:#E2931D;">nginx</span><span style="color:#91B859;"> -s</span><span style="color:#91B859;"> reload</span><span style="color:#91B859;">     因改变了Nginx相关配置，需要重新加载配置而重载。</span></span>
<span class="line"><span style="color:#E2931D;">nginx</span><span style="color:#91B859;"> -s</span><span style="color:#91B859;"> reopen</span><span style="color:#91B859;">     重新打开日志文件。</span></span>
<span class="line"><span style="color:#E2931D;">nginx</span><span style="color:#91B859;"> -c</span><span style="color:#91B859;"> filename</span><span style="color:#91B859;">   为</span><span style="color:#91B859;"> Nginx</span><span style="color:#91B859;"> 指定一个配置文件，来代替缺省的。</span></span>
<span class="line"><span style="color:#E2931D;">nginx</span><span style="color:#91B859;"> -t</span><span style="color:#91B859;">            不运行，仅仅测试配置文件。nginx</span><span style="color:#91B859;"> 将检查配置文件的语法的正确性，并尝试打开配置文件中所引用到的文件。</span></span>
<span class="line"><span style="color:#E2931D;">nginx</span><span style="color:#91B859;"> -v</span><span style="color:#91B859;">            显示</span><span style="color:#91B859;"> nginx</span><span style="color:#91B859;"> 的版本。</span></span>
<span class="line"><span style="color:#E2931D;">nginx</span><span style="color:#91B859;"> -V</span><span style="color:#91B859;">            显示</span><span style="color:#91B859;"> nginx</span><span style="color:#91B859;"> 的版本，编译器版本和配置参数</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="location" tabindex="-1">location <a class="header-anchor" href="#location" aria-label="Permalink to &quot;location&quot;">​</a></h2><div class="tip custom-block"><p class="custom-block-title">TIP</p><p><code>location</code> 指令用于定义服务器块（server block）中的不同位置（URL）上的请求处理规则。<br> 它允许您根据请求的 URL 路径来配置不同的行为，如代理到后端服务器、提供静态文件、重定向等</p></div><p><code>location [ = | ~ | ~* | ^~ ] uri { ... }</code></p><ul><li><code>=</code> 表示精确匹配</li><li><code>~</code> 表示区分大小写的正则匹配</li><li><code>~*</code> 表示不区分大小写的正则匹配</li><li><code>^~</code> 表示 uri 以某个字符串开头</li></ul><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#E2931D;">location</span><span style="color:#91B859;"> /</span><span style="color:#91B859;"> {</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">    # 针对所有请求的配置</span></span>
<span class="line"><span style="color:#90A4AE;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">location</span><span style="color:#91B859;"> =</span><span style="color:#91B859;"> /about</span><span style="color:#91B859;"> {</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">    # 针对精确匹配 /about 的请求</span></span>
<span class="line"><span style="color:#90A4AE;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">location</span><span style="color:#91B859;"> /blog/</span><span style="color:#91B859;"> {</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">    # 针对所有以 /blog/ 开头的 URL 请求</span></span>
<span class="line"><span style="color:#90A4AE;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">location</span><span style="color:#91B859;"> ~</span><span style="color:#91B859;"> ^/user/</span><span style="color:#91B859;"> {</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">    # 针对所有以 /user/ 开头的 URL 请求</span></span>
<span class="line"><span style="color:#90A4AE;">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">location</span><span style="color:#91B859;"> ~</span><span style="color:#90A4AE;">*</span><span style="color:#90A4AE;"> \\.</span><span style="color:#39ADB5;">(</span><span style="color:#E2931D;">jpg</span><span style="color:#39ADB5;">|</span><span style="color:#E2931D;">png</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;">$ </span><span style="color:#91B859;">{</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">    # 针对所有以 .jpg 或 .png 结尾的文件请求</span></span>
<span class="line"><span style="color:#90A4AE;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br></div></div><p><strong>location 的配置有两种形式，前缀字符和正则。</strong></p><ul><li><strong>查找匹配的时候，先查找前缀字符，选择最长匹配项，再查找正则。正则的优先级高于前缀字符。 正则等查找是按照在配置文件中的顺序进行的。因此正则等顺序很重要，建议越精细的放的越靠前。</strong></li><li><strong>使用=精准匹配可以加快查找的顺序，如果根域名经常被访问等话建议使用=。</strong></li></ul><h2 id="root-和-alias-的区别" tabindex="-1">root 和 alias 的区别 <a class="header-anchor" href="#root-和-alias-的区别" aria-label="Permalink to &quot;root 和 alias 的区别&quot;">​</a></h2><p><strong>root 是直接拼接 root + location</strong><br><strong>alias 是用 alias 替换 location</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#E2931D;">location</span><span style="color:#91B859;"> /i/</span><span style="color:#91B859;"> {</span></span>
<span class="line"><span style="color:#E2931D;">    root</span><span style="color:#91B859;"> /data/w3</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">}</span></span>
<span class="line"><span style="color:#E2931D;">当请求</span><span style="color:#91B859;"> /i/top.gif</span><span style="color:#91B859;"> ，/data/w3/i/top.gif</span><span style="color:#91B859;"> 会被返回。</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">location</span><span style="color:#91B859;"> /i/</span><span style="color:#91B859;"> {</span></span>
<span class="line"><span style="color:#6182B8;">    alias</span><span style="color:#91B859;"> /data/w3/images/</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">}</span></span>
<span class="line"><span style="color:#E2931D;">当请求</span><span style="color:#91B859;"> /i/top.gif</span><span style="color:#91B859;"> ，/data/w3/images/top.gif</span><span style="color:#91B859;"> 会被返回</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><p>所以如果你这样使用 allias 定义一个路径</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#E2931D;">location</span><span style="color:#91B859;"> /images/</span><span style="color:#91B859;"> {</span></span>
<span class="line"><span style="color:#6182B8;">    alias</span><span style="color:#91B859;"> /data/w3/images/</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p>使用 root 会更好</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#E2931D;">location</span><span style="color:#91B859;"> /images/</span><span style="color:#91B859;"> {</span></span>
<span class="line"><span style="color:#E2931D;">    root</span><span style="color:#91B859;"> /data/w3</span><span style="color:#39ADB5;">;</span></span>
<span class="line"><span style="color:#90A4AE;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div>`,15),o=[e];function c(r,t,i,b,y,d){return a(),n("div",null,o)}const B=s(p,[["render",c]]);export{m as __pageData,B as default};
