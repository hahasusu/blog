import{_ as s,c as n,o as a,a4 as l}from"./chunks/framework.GYzjcnJh.js";const m=JSON.parse('{"title":"仓库安装","description":"","frontmatter":{"date":"2023-11-06 21:56:06"},"headers":[],"relativePath":"tools/syncthing.md","filePath":"tools/syncthing.md"}'),p={name:"tools/syncthing.md"},e=l(`<div class="tip custom-block"><p class="custom-block-title">TIP</p><p>Syncthing 是一个开源的文件同步工具，它可以让你在不同的设备之间轻松地同步文件。</p></div><p><a href="https://github.com/syncthing/syncthing/releases/tag/v1.27.4" target="_blank" rel="noreferrer">https://github.com/syncthing/syncthing/releases/tag/v1.27.4</a></p><p>syncthing 核心应用程序是一个命令行程序，通常在后台运行并处理同步。</p><p>它提供了一个内置的、基于 HTML 和 JavaScript 的用户界面，可以通过 Web 浏览器进行控制。该前端通过一些 HTTP API 与核心应用程序进行通信</p><p><strong>选项</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;"># 第一次使用</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">#syncthing --home=$HOME/.config/syncthing --no-default-folder</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">#syncthing generate --gui-user=zbluo --gui-password=luozaibo</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">#syncthing --gui-address=0.0.0.0:8384</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 设置通用配置和数据目录。默认配置目录是</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># $XDG_STATE_HOME/syncthing or $HOME/.local/state/syncthing (Unix-like),</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># $HOME/Library/Application Support/Syncthing (Mac)</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># %LOCALAPPDATA%\\Syncthing (Windows)</span></span>
<span class="line"><span style="color:#90A4AE;">--home</span><span style="color:#39ADB5;">=&lt;</span><span style="color:#91B859;">dir</span><span style="color:#39ADB5;">&gt;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 替代 --home 且必须与 --data 一起使用</span></span>
<span class="line"><span style="color:#90A4AE;">--config</span><span style="color:#39ADB5;">=&lt;</span><span style="color:#91B859;">dir</span><span style="color:#39ADB5;">&gt;</span></span>
<span class="line"><span style="color:#90A4AE;">--data</span><span style="color:#39ADB5;">=&lt;</span><span style="color:#91B859;">dir</span><span style="color:#39ADB5;">&gt;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">--no-browser</span></span>
<span class="line"><span style="color:#E2931D;">--no-console</span><span style="color:#90A4AE;"> (On </span><span style="color:#91B859;">Windows</span><span style="color:#91B859;"> only</span><span style="color:#90A4AE;">)</span></span>
<span class="line"><span style="color:#E2931D;">--paths</span><span style="color:#90A4AE;font-style:italic;"> # 打印配置路径</span></span>
<span class="line"><span style="color:#E2931D;">-no-default-folde</span></span>
<span class="line"><span style="color:#90A4AE;">--gui-address</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">0.0.0.0:8384</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><h1 id="仓库安装" tabindex="-1">仓库安装 <a class="header-anchor" href="#仓库安装" aria-label="Permalink to &quot;仓库安装&quot;">​</a></h1><p>默认有<code>service</code> 文件 systemctl enable --now syncthing@root.service</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#E2931D;">dnf</span><span style="color:#91B859;"> install</span><span style="color:#91B859;"> -y</span><span style="color:#91B859;"> syncthing</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="设置成系统服务" tabindex="-1">设置成系统服务 <a class="header-anchor" href="#设置成系统服务" aria-label="Permalink to &quot;设置成系统服务&quot;">​</a></h2><p><code>vim /lib/systemd/system/syscthing@.service</code></p><p><code>systemctl enable --now syncthing@myuser.service</code></p><p><code>systemctl status syncthing@myuser.service</code></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">Unit</span><span style="color:#39ADB5;">]</span></span>
<span class="line"><span style="color:#90A4AE;">Description</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">Syncthing</span><span style="color:#E2931D;"> -</span><span style="color:#91B859;"> Open</span><span style="color:#91B859;"> Source</span><span style="color:#91B859;"> Continuous</span><span style="color:#91B859;"> File</span><span style="color:#91B859;"> Synchronization</span><span style="color:#91B859;"> for</span><span style="color:#91B859;"> %I</span></span>
<span class="line"><span style="color:#90A4AE;">Documentation</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">man:syncthing</span><span style="color:#39ADB5;">(</span><span style="color:#E2931D;">1</span><span style="color:#39ADB5;">)</span></span>
<span class="line"><span style="color:#90A4AE;">After</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">network.target</span></span>
<span class="line"><span style="color:#90A4AE;">StartLimitIntervalSec</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">60</span></span>
<span class="line"><span style="color:#90A4AE;">StartLimitBurst</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">4</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">Service</span><span style="color:#39ADB5;">]</span></span>
<span class="line"><span style="color:#90A4AE;">User</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">%i</span></span>
<span class="line"><span style="color:#90A4AE;">ExecStart</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">/usr/bin/syncthing</span><span style="color:#E2931D;"> serve</span><span style="color:#91B859;"> --no-browser</span><span style="color:#91B859;"> --no-restart</span><span style="color:#91B859;"> --logflags=0</span><span style="color:#91B859;"> --gui-address=0.0.0.0:8384</span></span>
<span class="line"><span style="color:#90A4AE;">Restart</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">on-failure</span></span>
<span class="line"><span style="color:#90A4AE;">RestartSec</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">1</span></span>
<span class="line"><span style="color:#90A4AE;">SuccessExitStatus</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">3</span><span style="color:#E2931D;"> 4</span></span>
<span class="line"><span style="color:#90A4AE;">RestartForceExitStatus</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">3</span><span style="color:#E2931D;"> 4</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># Hardening</span></span>
<span class="line"><span style="color:#90A4AE;">ProtectSystem</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">full</span></span>
<span class="line"><span style="color:#90A4AE;">PrivateTmp</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">true</span></span>
<span class="line"><span style="color:#90A4AE;">SystemCallArchitectures</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">native</span></span>
<span class="line"><span style="color:#90A4AE;">MemoryDenyWriteExecute</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">true</span></span>
<span class="line"><span style="color:#90A4AE;">NoNewPrivileges</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">true</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># Elevated permissions to sync ownership (disabled by default),</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># see https://docs.syncthing.net/advanced/folder-sync-ownership</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">#AmbientCapabilities=CAP_CHOWN CAP_FOWNER</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">Install</span><span style="color:#39ADB5;">]</span></span>
<span class="line"><span style="color:#90A4AE;">WantedBy</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">multi-user.target</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div>`,14),o=[e];function t(c,r,i,y,b,A){return a(),n("div",null,o)}const d=s(p,[["render",t]]);export{m as __pageData,d as default};
