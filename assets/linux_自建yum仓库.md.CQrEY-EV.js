import{_ as s,c as a,o as n,a4 as e}from"./chunks/framework.GYzjcnJh.js";const m=JSON.parse('{"title":"Rsync 同步 中科大 镜像源","description":"","frontmatter":{"data":"2024-03-28 16:14:53"},"headers":[],"relativePath":"linux/自建yum仓库.md","filePath":"linux/自建yum仓库.md"}'),l={name:"linux/自建yum仓库.md"},p=e(`<h1 id="rsync-同步-中科大-镜像源" tabindex="-1">Rsync 同步 中科大 镜像源 <a class="header-anchor" href="#rsync-同步-中科大-镜像源" aria-label="Permalink to &quot;Rsync 同步 中科大 镜像源&quot;">​</a></h1><p><a href="https://mirrors.ustc.edu.cn/help/rsync-guide.html" target="_blank" rel="noreferrer">科大源同步方法与注意事项</a></p><p>使用 rsync 协议访问科大开源镜像站，请使用 rsync 专用的域名： rsync.mirrors.ustc.edu.cn</p><h2 id="示例" tabindex="-1">示例 <a class="header-anchor" href="#示例" aria-label="Permalink to &quot;示例&quot;">​</a></h2><p>打开 <a href="https://mirrors.ustc.edu.cn/epel/8/Everything/x86_64/Packages/z/" target="_blank" rel="noreferrer">https://mirrors.ustc.edu.cn/epel/8/Everything/x86_64/Packages/z/</a></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;"># 查看同步有哪些文件</span></span>
<span class="line"><span style="color:#E2931D;">rsync</span><span style="color:#91B859;"> rsync://rsync.mirrors.ustc.edu.cn/epel/8/Everything/x86_64/Packages/z/</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="同步epel" tabindex="-1">同步EPEL <a class="header-anchor" href="#同步epel" aria-label="Permalink to &quot;同步EPEL&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;"># 目标目录不存在自动创建</span></span>
<span class="line"><span style="color:#E2931D;">rsync</span><span style="color:#91B859;"> -tvr</span><span style="color:#91B859;"> --include=</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;">repodata</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;"> --include=</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;">repodata/**</span><span style="color:#39ADB5;">&#39;</span><span style="color:#90A4AE;"> \\</span></span>
<span class="line"><span style="color:#91B859;">           --include=</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;">Packages</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;"> --include=</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;">Packages/**</span><span style="color:#39ADB5;">&#39;</span><span style="color:#90A4AE;"> \\</span></span>
<span class="line"><span style="color:#91B859;">           --exclude=</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;">*</span><span style="color:#39ADB5;">&#39;</span><span style="color:#90A4AE;"> \\</span></span>
<span class="line"><span style="color:#91B859;">           rsync://rsync.mirrors.ustc.edu.cn/epel/8/Everything/x86_64/</span><span style="color:#91B859;"> /data/repos/epel</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="同步baseos" tabindex="-1">同步BaseOS <a class="header-anchor" href="#同步baseos" aria-label="Permalink to &quot;同步BaseOS&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#E2931D;">rsync</span><span style="color:#91B859;"> -tvr</span><span style="color:#91B859;"> --include=</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;">repodata</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;"> --include=</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;">repodata/**</span><span style="color:#39ADB5;">&#39;</span><span style="color:#90A4AE;"> \\</span></span>
<span class="line"><span style="color:#91B859;">           --include=</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;">Packages</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;"> --include=</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;">Packages/**</span><span style="color:#39ADB5;">&#39;</span><span style="color:#90A4AE;"> \\</span></span>
<span class="line"><span style="color:#91B859;">           --exclude=</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;">*</span><span style="color:#39ADB5;">&#39;</span><span style="color:#90A4AE;"> \\</span></span>
<span class="line"><span style="color:#91B859;">           rsync://rsync.mirrors.ustc.edu.cn/centos/8-stream/BaseOS/x86_64/os/</span><span style="color:#90A4AE;"> \\</span></span>
<span class="line"><span style="color:#91B859;">           /data/repos/BaseOS</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br></div></div><h2 id="同步appstream" tabindex="-1">同步AppStream <a class="header-anchor" href="#同步appstream" aria-label="Permalink to &quot;同步AppStream&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#E2931D;">rsync</span><span style="color:#91B859;"> -tvr</span><span style="color:#91B859;"> --include=</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;">repodata</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;"> --include=</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;">repodata/**</span><span style="color:#39ADB5;">&#39;</span><span style="color:#90A4AE;"> \\</span></span>
<span class="line"><span style="color:#91B859;">           --include=</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;">Packages</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;"> --include=</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;">Packages/**</span><span style="color:#39ADB5;">&#39;</span><span style="color:#90A4AE;"> \\</span></span>
<span class="line"><span style="color:#91B859;">           --exclude=</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;">*</span><span style="color:#39ADB5;">&#39;</span><span style="color:#90A4AE;"> \\</span></span>
<span class="line"><span style="color:#91B859;">           rsync://rsync.mirrors.ustc.edu.cn/centos/8-stream/AppStream/x86_64/os/</span><span style="color:#90A4AE;"> \\</span></span>
<span class="line"><span style="color:#91B859;">           /data/repos/AppStream</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="每天定时同步" tabindex="-1">每天定时同步 <a class="header-anchor" href="#每天定时同步" aria-label="Permalink to &quot;每天定时同步&quot;">​</a></h2><p><code>vim /usr/local/bin/cron_rsync_yum.sh</code></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">rsync_</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">/usr/bin/rsync</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">pattern</span><span style="color:#39ADB5;">=</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;">$rsync_</span><span style="color:#91B859;"> -tr --include=&#39;repodata&#39; --include=&#39;repodata/**&#39; </span><span style="color:#90A4AE;">\\</span></span>
<span class="line"><span style="color:#91B859;">                 --include=&#39;Packages&#39; --include=&#39;Packages/**&#39; </span><span style="color:#90A4AE;">\\</span></span>
<span class="line"><span style="color:#91B859;">                 --exclude=&#39;*&#39; </span><span style="color:#90A4AE;">\\</span></span>
<span class="line"><span style="color:#39ADB5;">                &quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">$pattern rsync://rsync.mirrors.ustc.edu.cn/centos/8-stream/BaseOS/x86_64/os/ \\</span></span>
<span class="line"><span style="color:#E2931D;">         /data/repos/BaseOS</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">$pattern rsync://rsync.mirrors.ustc.edu.cn/centos/8-stream/AppStream/x86_64/os/ \\</span></span>
<span class="line"><span style="color:#E2931D;">            /data/repos/AppStream</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">$pattern rsync://rsync.mirrors.ustc.edu.cn/epel/8/Everything/x86_64/ /data/repos/epel \\</span></span>
<span class="line"><span style="color:#E2931D;">         /data/repos/AppStream</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br></div></div><p><code>chmod +x /usr/local/bin/cron_rsync_yum.sh</code></p><p><strong>创建定时任务</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#E2931D;">crontab</span><span style="color:#91B859;"> -e</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">0</span><span style="color:#F76D47;"> 22</span><span style="color:#90A4AE;"> *</span><span style="color:#90A4AE;"> *</span><span style="color:#90A4AE;"> *</span><span style="color:#91B859;"> /usr/local/bin/cron_rsync_yum.sh</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br></div></div><p><strong>查看任务</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#E2931D;">crontab</span><span style="color:#91B859;"> -l</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div>`,20),r=[p];function o(c,t,i,y,d,u){return n(),a("div",null,r)}const A=s(l,[["render",o]]);export{m as __pageData,A as default};
