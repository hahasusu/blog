import{_ as e,c as a,o as i,a4 as t}from"./chunks/framework.GYzjcnJh.js";const m=JSON.parse('{"title":"","description":"","frontmatter":{"date":"2024-02-22 04:56:30"},"headers":[],"relativePath":"db/redis/persistence.md","filePath":"backend/db/redis/persistence.md"}'),l={name:"db/redis/persistence.md"},o=t('<p><a href="https://redis.io/docs/management/persistence/" target="_blank" rel="noreferrer">https://redis.io/docs/management/persistence/</a></p><h2 id="rdb-redis-database-快照" tabindex="-1">RDB(Redis Database) 快照 <a class="header-anchor" href="#rdb-redis-database-快照" aria-label="Permalink to &quot;RDB(Redis Database) 快照&quot;">​</a></h2><ul><li>dir</li><li>dbfilenmae</li></ul><p><img src="http://pic.justdoiit.top/imgs/2024-03-01-1709271245.webp" alt="" loading="lazy"></p><ol><li><strong>自动触发</strong><br> 默认规则（save 3600 1 300 100 60 10000）</li><li><strong>手动触发</strong><ul><li>save</li><li>bgsave(1千万条数据rdb文件200M)</li></ul></li></ol><p>生成rdb文件的</p><ol><li>配置文件中的配置</li><li>手动bgsave</li><li>flushall flushdb,但里面是空的，无意义</li><li>shutdown 并且没有开启AOF</li><li>主从复制时，主节点自动触发</li></ol><p>禁用RDB</p><ol><li>配置文件中修改 save=&quot;&quot;</li><li>redis-cli config set save=&quot;&quot;</li></ol><h3 id="rdb相关配置" tabindex="-1">RDB相关配置 <a class="header-anchor" href="#rdb相关配置" aria-label="Permalink to &quot;RDB相关配置&quot;">​</a></h3><p><img src="http://pic.justdoiit.top/imgs/2024-03-01-1709271879.webp" alt="" loading="lazy"></p><h2 id="aof-append-only-file-写日志" tabindex="-1">AOF(Append Only File) 写日志 <a class="header-anchor" href="#aof-append-only-file-写日志" aria-label="Permalink to &quot;AOF(Append Only File) 写日志&quot;">​</a></h2><p>以日志的形式来记录每个写操作 <img src="http://pic.justdoiit.top/imgs/2024-03-01-1709273967.webp" alt="" loading="lazy"></p><p><img src="http://pic.justdoiit.top/imgs/2024-03-01-1709274047.webp" alt="" loading="lazy"> 默认是没有开启的， <code>appendonly yes</code></p><p>存放目录 appendonlydir=...</p><h3 id="aof相关配置" tabindex="-1">AOF相关配置 <a class="header-anchor" href="#aof相关配置" aria-label="Permalink to &quot;AOF相关配置&quot;">​</a></h3><p><img src="http://pic.justdoiit.top/imgs/2024-03-01-1709274133.webp" alt="" loading="lazy"></p><p>持久化工作流程</p><p>写回策略</p><ol><li><code>always</code> 同步写回，每个写命令执行完立刻写回磁盘</li><li>everysec 默认 每隔1s写回</li><li>no 每个写命令执行完，只是先将日志写到AOF文件的内存缓冲区</li></ol><h3 id="aof-rewrite" tabindex="-1">AOF rewrite <a class="header-anchor" href="#aof-rewrite" aria-label="Permalink to &quot;AOF rewrite&quot;">​</a></h3><p><img src="http://pic.justdoiit.top/imgs/2024-03-01-1709274558.webp" alt="" loading="lazy"></p><h3 id="aof优缺点" tabindex="-1">AOF优缺点 <a class="header-anchor" href="#aof优缺点" aria-label="Permalink to &quot;AOF优缺点&quot;">​</a></h3><p><img src="http://pic.justdoiit.top/imgs/2024-03-01-1709274936.webp" alt="" loading="lazy"></p>',24),s=[o];function r(d,p,n,c,h,b){return i(),a("div",null,s)}const g=e(l,[["render",r]]);export{m as __pageData,g as default};
