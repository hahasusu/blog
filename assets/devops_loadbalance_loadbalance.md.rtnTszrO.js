import{_ as a,c as s,o as n,a4 as l}from"./chunks/framework.GYzjcnJh.js";const m=JSON.parse('{"title":"","description":"","frontmatter":{"date":"2024-03-04 21:57:58"},"headers":[],"relativePath":"devops/loadbalance/loadbalance.md","filePath":"devops/loadbalance/loadbalance.md"}'),e={name:"devops/loadbalance/loadbalance.md"},p=l(`<h2 id="集群" tabindex="-1">集群 <a class="header-anchor" href="#集群" aria-label="Permalink to &quot;集群&quot;">​</a></h2><p><code>cluster</code>: 为解决特定问题将多台计算机组合起来形成的单个系统</p><p><strong>cluster三种类型</strong></p><ol><li>LB(负载均衡)</li><li>HA(高可用)</li><li>HPC</li></ol><p>四层负载均衡，指的是工作在 OSI 的第四层，即传输层，其通过 IP + 端口的方式进行路由转发。其具体实现方式为：通过报文中的 IP 地址和端口，再加上负载均衡设备所采用的负载均衡算法，最终确定选择后端哪台下游服务器</p><p>七层负载均衡，指的是工作在 OSI 的第七层，即应用层，其一般是基于请求 URL 地址的方式进行代理转发。七层服务均衡在应用层选择服务器，只能先与负载均衡设备进行 TCP 连接，然后负载均衡设备再与后端服务器建立另外一条 TCP 连接通道</p><h2 id="lvs" tabindex="-1">LVS <a class="header-anchor" href="#lvs" aria-label="Permalink to &quot;LVS&quot;">​</a></h2><p><strong>工作模式</strong></p><p><img src="http://pic.justdoiit.top/imgs/2024-03-06-1709699243.webp" alt="" loading="lazy"></p><p><strong>NAT</strong><img src="http://pic.justdoiit.top/imgs/2024-03-06-1709699544.webp" alt="" loading="lazy"></p><p>请求报文 和 响应报文都经过VS 转发，容易成为性能瓶颈</p><h3 id="比较" tabindex="-1">比较 <a class="header-anchor" href="#比较" aria-label="Permalink to &quot;比较&quot;">​</a></h3><p><img src="http://pic.justdoiit.top/imgs/2024-03-06-1709700947.webp" alt="" loading="lazy"></p><h3 id="调度算法" tabindex="-1">调度算法 <a class="header-anchor" href="#调度算法" aria-label="Permalink to &quot;调度算法&quot;">​</a></h3><p><img src="http://pic.justdoiit.top/imgs/2024-03-06-1709701090.webp" alt="" loading="lazy"></p><p><strong>动态</strong><img src="http://pic.justdoiit.top/imgs/2024-03-06-1709701636.webp" alt="" loading="lazy"></p><h3 id="ipvsadm工具" tabindex="-1">ipvsadm工具 <a class="header-anchor" href="#ipvsadm工具" aria-label="Permalink to &quot;ipvsadm工具&quot;">​</a></h3><p><img src="http://pic.justdoiit.top/imgs/2024-03-06-1709702188.webp" alt="" loading="lazy"></p><h3 id="管理集群" tabindex="-1">管理集群 <a class="header-anchor" href="#管理集群" aria-label="Permalink to &quot;管理集群&quot;">​</a></h3><p><img src="http://pic.justdoiit.top/imgs/2024-03-06-1709702487.webp" alt="" loading="lazy"></p><h3 id="管理集群上的rs" tabindex="-1">管理集群上的RS <a class="header-anchor" href="#管理集群上的rs" aria-label="Permalink to &quot;管理集群上的RS&quot;">​</a></h3><p><img src="http://pic.justdoiit.top/imgs/2024-03-06-1709702435.webp" alt="" loading="lazy"></p><h3 id="规则文件保存" tabindex="-1">规则文件保存 <a class="header-anchor" href="#规则文件保存" aria-label="Permalink to &quot;规则文件保存&quot;">​</a></h3><p><code>cat /usr/lib/systemd/system/ipvsadm.service</code></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">Unit</span><span style="color:#39ADB5;">]</span></span>
<span class="line"><span style="color:#90A4AE;">Description</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">Initialise</span><span style="color:#E2931D;"> the</span><span style="color:#91B859;"> Linux</span><span style="color:#91B859;"> Virtual</span><span style="color:#91B859;"> Server</span></span>
<span class="line"><span style="color:#90A4AE;">After</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">syslog.target</span><span style="color:#E2931D;"> network.target</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">Service</span><span style="color:#39ADB5;">]</span></span>
<span class="line"><span style="color:#90A4AE;">Type</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">oneshot</span></span>
<span class="line"><span style="color:#90A4AE;">ExecStart</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">/bin/bash</span><span style="color:#E2931D;"> -c</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">exec /sbin/ipvsadm-restore &lt; /etc/sysconfig/ipvsadm</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"><span style="color:#90A4AE;">ExecStop</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">/bin/bash</span><span style="color:#E2931D;"> -c</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">exec /sbin/ipvsadm-save -n &gt; /etc/sysconfig/ipvsadm</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"><span style="color:#90A4AE;">ExecStop</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">/sbin/ipvsadm</span><span style="color:#E2931D;"> -C</span></span>
<span class="line"><span style="color:#90A4AE;">RemainAfterExit</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">yes</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">Install</span><span style="color:#39ADB5;">]</span></span>
<span class="line"><span style="color:#90A4AE;">WantedBy</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">multi-user.target</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br></div></div><h2 id="nginx" tabindex="-1">Nginx <a class="header-anchor" href="#nginx" aria-label="Permalink to &quot;Nginx&quot;">​</a></h2><h2 id="haproxy" tabindex="-1">HAProxy <a class="header-anchor" href="#haproxy" aria-label="Permalink to &quot;HAProxy&quot;">​</a></h2>`,27),o=[p];function t(r,i,c,d,b,h){return n(),s("div",null,o)}const u=a(e,[["render",t]]);export{m as __pageData,u as default};
