import{_ as s,c as n,o as a,a4 as e}from"./chunks/framework.GYzjcnJh.js";const d=JSON.parse('{"title":"","description":"","frontmatter":{},"headers":[],"relativePath":"promethus/安装.md","filePath":"promethus/安装.md"}'),l={name:"promethus/安装.md"},p=e(`<p>github下载页：<a href="https://github.com/prometheus/prometheus/releases" target="_blank" rel="noreferrer">https://github.com/prometheus/prometheus/releases</a></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#E2931D;">wget</span><span style="color:#91B859;"> https://github.com/prometheus/prometheus/releases/download/v2.51.1/prometheus-2.51.1.linux-amd64.tar.gz</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">tar</span><span style="color:#91B859;"> xf</span><span style="color:#91B859;"> prometheus-2.51.1.linux-amd64.tar.gz</span><span style="color:#91B859;"> -C</span><span style="color:#91B859;"> /usr/local</span></span>
<span class="line"><span style="color:#E2931D;">ln</span><span style="color:#91B859;"> -sv</span><span style="color:#91B859;"> /usr/local/prometheus-2.51.1.linux-amd64/</span><span style="color:#91B859;"> /usr/local/prometheus</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 创建用户，并设定目录权限</span></span>
<span class="line"><span style="color:#E2931D;">useradd</span><span style="color:#91B859;"> -r</span><span style="color:#91B859;"> prometheus</span></span>
<span class="line"><span style="color:#E2931D;">mkdir</span><span style="color:#91B859;"> -p</span><span style="color:#91B859;"> /data/prometheus</span></span>
<span class="line"><span style="color:#E2931D;">chown</span><span style="color:#91B859;"> -R</span><span style="color:#91B859;"> prometheus.prometheus</span><span style="color:#91B859;"> /data/prometheus</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br></div></div><p><strong>创建service文件</strong>: <code>/lib/systemd/system/prometheus.service</code></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">Unit</span><span style="color:#39ADB5;">]</span></span>
<span class="line"><span style="color:#90A4AE;">Description</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">Monitoring</span><span style="color:#E2931D;"> system</span><span style="color:#91B859;"> and</span><span style="color:#91B859;"> time</span><span style="color:#91B859;"> series</span><span style="color:#91B859;"> database</span></span>
<span class="line"><span style="color:#90A4AE;">Documentation</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">https://prometheus.io/docs/introduction/overview/</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">Service</span><span style="color:#39ADB5;">]</span></span>
<span class="line"><span style="color:#90A4AE;">Restart</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">always</span></span>
<span class="line"><span style="color:#90A4AE;">User</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">prometheus</span></span>
<span class="line"><span style="color:#90A4AE;">EnvironmentFile</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">-/etc/default/prometheus</span></span>
<span class="line"><span style="color:#90A4AE;">ExecStart</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">/usr/local/prometheus/prometheus</span><span style="color:#E2931D;"> \\</span></span>
<span class="line"><span style="color:#91B859;">            --config.file=/usr/local/prometheus/prometheus.yml</span><span style="color:#90A4AE;"> \\</span></span>
<span class="line"><span style="color:#91B859;">            --storage.tsdb.path=/data/prometheus</span><span style="color:#90A4AE;"> \\</span></span>
<span class="line"><span style="color:#91B859;">            --web.console.libraries=/usr/share/prometheus/console_libraries</span><span style="color:#90A4AE;"> \\</span></span>
<span class="line"><span style="color:#91B859;">            --web.enable-lifecycle</span><span style="color:#90A4AE;"> \\</span></span>
<span class="line"><span style="color:#90A4AE;">            $ARGS</span></span>
<span class="line"><span style="color:#90A4AE;">ExecReload</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">/bin/kill</span><span style="color:#E2931D;"> -HUP</span><span style="color:#90A4AE;"> $MAINPID</span></span>
<span class="line"><span style="color:#90A4AE;">TimeoutStopSec</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">20s</span></span>
<span class="line"><span style="color:#90A4AE;">SendSIGKILL</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">no</span></span>
<span class="line"><span style="color:#90A4AE;">LimitNOFILE</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">8192</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">Install</span><span style="color:#39ADB5;">]</span></span>
<span class="line"><span style="color:#90A4AE;">WantedBy</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">multi-user.target</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br></div></div><p>可选创建环境配置文件/etc/default/prometheus，通过变量<code>ARGS</code>为<code>prometheus</code>指定启动参数</p><p><strong>启动服务并验证</strong>:</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#E2931D;">systemctl</span><span style="color:#91B859;"> daemon-reload</span></span>
<span class="line"><span style="color:#E2931D;">systemctl</span><span style="color:#91B859;"> start</span><span style="color:#91B859;"> prometheus</span></span>
<span class="line"><span style="color:#E2931D;">systemctl</span><span style="color:#91B859;"> enable</span><span style="color:#91B859;"> prometheus</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">ss</span><span style="color:#91B859;"> -tnlp</span><span style="color:#39ADB5;"> |</span><span style="color:#E2931D;"> grep</span><span style="color:#39ADB5;"> &#39;</span><span style="color:#91B859;">9090</span><span style="color:#39ADB5;">&#39;</span></span>
<span class="line"><span style="color:#E2931D;">curl</span><span style="color:#91B859;"> localhost:9090/metrics</span></span>
<span class="line"><span style="color:#E2931D;">浏览器打开</span><span style="color:#91B859;"> http://ip:9090</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div>`,7),o=[p];function r(t,c,i,y,m,u){return a(),n("div",null,o)}const h=s(l,[["render",r]]);export{d as __pageData,h as default};
