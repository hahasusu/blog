import{_ as s,c as n,o as a,a4 as l}from"./chunks/framework.GYzjcnJh.js";const m=JSON.parse('{"title":"第四周","description":null,"frontmatter":{"title":"第四周","description":null,"date":"2023-10-16T15:06:35.000Z","tags":["task"],"lastUpdated":"aa"},"headers":[],"relativePath":"other/task/fourth.md","filePath":"other/task/fourth.md"}'),p={name:"other/task/fourth.md"},e=l(`<h1 id="第四周" tabindex="-1">第四周 <a class="header-anchor" href="#第四周" aria-label="Permalink to &quot;第四周&quot;">​</a></h1><h2 id="_1-总结脚本高级命令trap-install-mktemp-expect-进程优先级命令-nice-renice-进程管理工具-ps-pstree-prtstat-pgrep-pidof-uptime-mpstat-top-htop-free-pmap-vmstat-iostat-iotop-iftop-nload-nethogs-iptraf-ng-dstat-glances-cockpit-kill-job-任务相关的命令-at-crontab-命令-选项-示例。" tabindex="-1">1. 总结脚本高级命令trap, install, mktemp, expect, 进程优先级命令：nice, renice, 进程管理工具: ps, pstree, prtstat, pgrep, pidof, uptime,mpstat,top,htop, free, pmap, vmstat, iostat, iotop, iftop, nload, nethogs, iptraf-ng, dstat, glances, cockpit, kill, job, 任务相关的命令: at, crontab, 命令，选项，示例。 <a class="header-anchor" href="#_1-总结脚本高级命令trap-install-mktemp-expect-进程优先级命令-nice-renice-进程管理工具-ps-pstree-prtstat-pgrep-pidof-uptime-mpstat-top-htop-free-pmap-vmstat-iostat-iotop-iftop-nload-nethogs-iptraf-ng-dstat-glances-cockpit-kill-job-任务相关的命令-at-crontab-命令-选项-示例。" aria-label="Permalink to &quot;1. 总结脚本高级命令trap, install, mktemp, expect, 进程优先级命令：nice, renice, 进程管理工具: ps, pstree, prtstat, pgrep, pidof, uptime,mpstat,top,htop, free, pmap, vmstat, iostat, iotop, iftop, nload, nethogs, iptraf-ng, dstat, glances, cockpit, kill, job, 任务相关的命令: at, crontab, 命令，选项，示例。&quot;">​</a></h2><p>脚本高级命令trap, install, mktemp, expect<br><strong>trap（捕获信号)：避免了错误信号让程序终止的异常</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"></span>
<span class="line"><span style="color:#6182B8;">trap</span><span style="color:#91B859;"> -l</span></span>
<span class="line"><span style="color:#E2931D;"> 1</span><span style="color:#90A4AE;">) SIGHUP       2) SIGINT       3) SIGQUIT      4) SIGILL       5) SIGTRAP</span></span>
<span class="line"><span style="color:#E2931D;"> 6</span><span style="color:#90A4AE;">) SIGABRT      7) SIGBUS       8) SIGFPE       9) SIGKILL     10) SIGUSR1</span></span>
<span class="line"><span style="color:#E2931D;">11</span><span style="color:#90A4AE;">) SIGSEGV     12) SIGUSR2     13) SIGPIPE     14) SIGALRM     15) SIGTERM</span></span>
<span class="line"><span style="color:#E2931D;">16</span><span style="color:#90A4AE;">) SIGSTKFLT   17) SIGCHLD     18) SIGCONT     19) SIGSTOP     20) SIGTSTP</span></span>
<span class="line"><span style="color:#E2931D;">21</span><span style="color:#90A4AE;">) SIGTTIN     22) SIGTTOU     23) SIGURG      24) SIGXCPU     25) SIGXFSZ</span></span>
<span class="line"><span style="color:#E2931D;">26</span><span style="color:#90A4AE;">) SIGVTALRM   27) SIGPROF     28) SIGWINCH    29) SIGIO       30) SIGPWR</span></span>
<span class="line"><span style="color:#E2931D;">31</span><span style="color:#90A4AE;">) SIGSYS      34) SIGRTMIN    35) SIGRTMIN+1  36) SIGRTMIN+2  37) SIGRTMIN+3</span></span>
<span class="line"><span style="color:#E2931D;">38</span><span style="color:#90A4AE;">) SIGRTMIN+4  39) SIGRTMIN+5  40) SIGRTMIN+6  41) SIGRTMIN+7  42) SIGRTMIN+8</span></span>
<span class="line"><span style="color:#E2931D;">43</span><span style="color:#90A4AE;">) SIGRTMIN+9  44) SIGRTMIN+10 45) SIGRTMIN+11 46) SIGRTMIN+12 47) SIGRTMIN+13</span></span>
<span class="line"><span style="color:#E2931D;">48</span><span style="color:#90A4AE;">) SIGRTMIN+14 49) SIGRTMIN+15 50) SIGRTMAX-14 51) SIGRTMAX-13 52) SIGRTMAX-12</span></span>
<span class="line"><span style="color:#E2931D;">53</span><span style="color:#90A4AE;">) SIGRTMAX-11 54) SIGRTMAX-10 55) SIGRTMAX-9  56) SIGRTMAX-8  57) SIGRTMAX-7</span></span>
<span class="line"><span style="color:#E2931D;">58</span><span style="color:#90A4AE;">) SIGRTMAX-6  59) SIGRTMAX-5  60) SIGRTMAX-4  61) SIGRTMAX-3  62) SIGRTMAX-2</span></span>
<span class="line"><span style="color:#E2931D;">63</span><span style="color:#90A4AE;">) SIGRTMAX-1  64) SIGRTMAX</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 系统发出指令信号时，将执行自定义指令，不执行原操作</span></span>
<span class="line"><span style="color:#6182B8;">trap</span><span style="color:#39ADB5;"> &#39;</span><span style="color:#91B859;">触发指令</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;"> 信号</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 忽略信号操作</span></span>
<span class="line"><span style="color:#6182B8;">trap</span><span style="color:#39ADB5;"> &#39;&#39;</span><span style="color:#91B859;"> 信号</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 恢复原信号操作</span></span>
<span class="line"><span style="color:#6182B8;">trap</span><span style="color:#39ADB5;"> &#39;</span><span style="color:#91B859;">-</span><span style="color:#39ADB5;">&#39;</span><span style="color:#91B859;"> 信号</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 列出自定义信号</span></span>
<span class="line"><span style="color:#6182B8;">trap</span><span style="color:#91B859;"> -p</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 当前脚本退出时，执行finish函数</span></span>
<span class="line"><span style="color:#6182B8;">trap</span><span style="color:#91B859;"> finish</span><span style="color:#91B859;"> EXIT</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br></div></div><p><strong>install：相当于mkdir、cp、改属性</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;"># 拷贝</span></span>
<span class="line"><span style="color:#E2931D;">install</span><span style="color:#91B859;"> a</span><span style="color:#91B859;"> /opt</span><span style="color:#90A4AE;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 只创建目录</span></span>
<span class="line"><span style="color:#E2931D;">install</span><span style="color:#91B859;"> -d</span><span style="color:#90A4AE;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 修改权限</span></span>
<span class="line"><span style="color:#E2931D;">install</span><span style="color:#91B859;"> -m</span><span style="color:#F76D47;"> 600</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 修改所属主own</span></span>
<span class="line"><span style="color:#E2931D;">install</span><span style="color:#91B859;"> -o</span><span style="color:#90A4AE;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 修改所属组</span></span>
<span class="line"><span style="color:#E2931D;">install</span><span style="color:#91B859;"> -g</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><p><strong>临时文件的创建（mktemp）</strong></p><p><strong>交互式转化批处理工具（expect）</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;"># 自动登录</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">#!/usr/bin/expect</span></span>
<span class="line"><span style="color:#E2931D;">spawn</span><span style="color:#91B859;"> ssh</span><span style="color:#F76D47;"> 192.168.100.131</span></span>
<span class="line"><span style="color:#E2931D;">expect</span><span style="color:#91B859;"> {</span></span>
<span class="line"><span style="color:#E2931D;">        &quot;yes/no&quot;</span><span style="color:#91B859;"> {</span><span style="color:#91B859;"> send</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">yes\\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;">;</span><span style="color:#E2931D;">ecp_continue</span><span style="color:#91B859;"> }</span></span>
<span class="line"><span style="color:#E2931D;">        &quot;password&quot;</span><span style="color:#91B859;"> {</span><span style="color:#91B859;"> send</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">111111\\n</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">}</span></span>
<span class="line"><span style="color:#90A4AE;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h3 id="任务相关命令" tabindex="-1">任务相关命令 <a class="header-anchor" href="#任务相关命令" aria-label="Permalink to &quot;任务相关命令&quot;">​</a></h3><details class="details custom-block"><summary><code>at, crontab</code></summary><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;"># 一次性任务（at）</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 标准输出和标准错误都不会显示</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost </span><span style="color:#39ADB5;">~]</span><span style="color:#90A4AE;"># at 15:13</span></span>
<span class="line"><span style="color:#E2931D;">warning:</span><span style="color:#91B859;"> commands</span><span style="color:#91B859;"> will</span><span style="color:#91B859;"> be</span><span style="color:#91B859;"> executed</span><span style="color:#91B859;"> using</span><span style="color:#91B859;"> /bin/sh</span></span>
<span class="line"><span style="color:#E2931D;">at</span><span style="color:#90A4AE;">&gt; </span><span style="color:#91B859;">touch</span><span style="color:#91B859;"> /data/at.log</span></span>
<span class="line"><span style="color:#E2931D;">at</span><span style="color:#90A4AE;">&gt; </span><span style="color:#39ADB5;">&lt;</span><span style="color:#91B859;">EO</span><span style="color:#90A4AE;">T</span><span style="color:#39ADB5;">&gt;</span><span style="color:#91B859;">#CTRL+d：退出</span></span>
<span class="line"><span style="color:#E2931D;">job</span><span style="color:#F76D47;"> 1</span><span style="color:#91B859;"> at</span><span style="color:#91B859;"> Sat</span><span style="color:#91B859;"> Feb</span><span style="color:#F76D47;"> 11</span><span style="color:#91B859;"> 15:13:00</span><span style="color:#F76D47;"> 2023</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 两分钟之后执行任务</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost </span><span style="color:#39ADB5;">~]</span><span style="color:#90A4AE;"># at now+2min</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">warning:</span><span style="color:#91B859;"> commands</span><span style="color:#91B859;"> will</span><span style="color:#91B859;"> be</span><span style="color:#91B859;"> executed</span><span style="color:#91B859;"> using</span><span style="color:#91B859;"> /bin/sh</span></span>
<span class="line"><span style="color:#E2931D;">at</span><span style="color:#90A4AE;">&gt; </span><span style="color:#91B859;">touch</span><span style="color:#91B859;"> /data/at2.log</span></span>
<span class="line"><span style="color:#E2931D;">at</span><span style="color:#90A4AE;">&gt; </span><span style="color:#39ADB5;">&lt;</span><span style="color:#91B859;">EO</span><span style="color:#90A4AE;">T</span><span style="color:#39ADB5;">&gt;</span></span>
<span class="line"><span style="color:#E2931D;">job</span><span style="color:#F76D47;"> 2</span><span style="color:#91B859;"> at</span><span style="color:#91B859;"> Sat</span><span style="color:#91B859;"> Feb</span><span style="color:#F76D47;"> 11</span><span style="color:#91B859;"> 15:19:00</span><span style="color:#F76D47;"> 2023</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost </span><span style="color:#39ADB5;">~]</span><span style="color:#90A4AE;"># at -l</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">2</span><span style="color:#91B859;">       Sat</span><span style="color:#91B859;"> Feb</span><span style="color:#F76D47;"> 11</span><span style="color:#91B859;"> 15:19:00</span><span style="color:#F76D47;"> 2023</span><span style="color:#91B859;"> a</span><span style="color:#91B859;"> root</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 删除计划任务</span></span>
<span class="line"><span style="color:#E2931D;">at</span><span style="color:#91B859;"> -d</span><span style="color:#F76D47;"> 2</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 用户创建的计划任务(crontab)</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 存放地址：/var/spool/cron/</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 执行计划任务</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost </span><span style="color:#39ADB5;">~]</span><span style="color:#90A4AE;"># crontab -e</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 产看计划是否执行</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost </span><span style="color:#39ADB5;">~]</span><span style="color:#90A4AE;"># cat /var/log/cron</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 查看计划任务内容</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost </span><span style="color:#39ADB5;">~]</span><span style="color:#90A4AE;"># crontab -l</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">PATH</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">/root/.local/bin:/root/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin</span></span>
<span class="line"><span style="color:#39ADB5;">*</span><span style="color:#39ADB5;"> *</span><span style="color:#39ADB5;"> *</span><span style="color:#39ADB5;"> *</span><span style="color:#39ADB5;"> *</span><span style="color:#90A4AE;"> echo $PATH </span><span style="color:#39ADB5;">&gt;&gt;</span><span style="color:#90A4AE;"> /data/path.log</span><span style="color:#39ADB5;">;</span><span style="color:#E2931D;"> ip</span><span style="color:#91B859;"> address</span><span style="color:#39ADB5;"> &amp;&gt;</span><span style="color:#90A4AE;"> /data/ip.log</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 删除计划任务</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost </span><span style="color:#39ADB5;">~]</span><span style="color:#90A4AE;"># crontab -r</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost </span><span style="color:#39ADB5;">~]</span><span style="color:#90A4AE;"># cat /var/spool/cron</span></span>
<span class="line"><span style="color:#E2931D;">cat:</span><span style="color:#91B859;"> /var/spool/cron:</span><span style="color:#91B859;"> Is</span><span style="color:#91B859;"> a</span><span style="color:#91B859;"> directory</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 指定以xie的用户来执行计划任务</span></span>
<span class="line"><span style="color:#E2931D;">crontab</span><span style="color:#91B859;"> -e</span><span style="color:#91B859;"> -u</span><span style="color:#91B859;"> xie</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 控制黑名单和白名单</span></span>
<span class="line"><span style="color:#E2931D;">/etc/cron.</span><span style="color:#91B859;">{allow,deny}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br></div></div></details><h2 id="_2-总结索引数组和关联数组-字符串处理-高级变量使用及示例。" tabindex="-1">2. 总结索引数组和关联数组，字符串处理，高级变量使用及示例。 <a class="header-anchor" href="#_2-总结索引数组和关联数组-字符串处理-高级变量使用及示例。" aria-label="Permalink to &quot;2. 总结索引数组和关联数组，字符串处理，高级变量使用及示例。&quot;">​</a></h2><p><strong>索引数组</strong>：</p><ul><li>索引数组：索引的编号从0开始</li><li>声明数组：declare -a NAME</li><li>删除数组：unset NAME</li><li>交互式数组赋值：read -a NAME</li></ul><p><strong>关联数组</strong>:<br> 索引可支持自定义的格式，不仅仅是数字，bash4.0之后支持</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;"># 声明数组</span></span>
<span class="line"><span style="color:#9C3EDA;">declare</span><span style="color:#91B859;"> -A</span><span style="color:#90A4AE;"> NAME</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 查看元素的个数</span></span>
<span class="line"><span style="color:#6182B8;">echo</span><span style="color:#39ADB5;"> \${#</span><span style="color:#90A4AE;">num</span><span style="color:#39ADB5;">[*]}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 新添加一个元素</span></span>
<span class="line"><span style="color:#E2931D;">num[$</span><span style="color:#91B859;">{#num[*]}</span><span style="color:#E2931D;">]</span><span style="color:#91B859;">=11</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>字符串处理</strong></p><details class="details custom-block"><summary>Details</summary><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;"># 基于模式取字符串</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 从左到右找到&#39;/&#39;把斜杠和前面的内容删除</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># url</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">http://www.baidu.com/index.html</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># echo </span><span style="color:#39ADB5;">\${</span><span style="color:#90A4AE;">url</span><span style="color:#39ADB5;">#*/}</span></span>
<span class="line"><span style="color:#E2931D;">/www.baidu.com/index.html</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 删除所有斜杠之前的呢容</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># echo </span><span style="color:#39ADB5;">\${</span><span style="color:#90A4AE;">url</span><span style="color:#39ADB5;">##*/}</span></span>
<span class="line"><span style="color:#E2931D;">index.html</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 从右到左找到&#39;/&#39;把斜杠和后面的内容删除</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># url</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">http://www.baidu.com/index.html</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># echo </span><span style="color:#39ADB5;">\${</span><span style="color:#90A4AE;">url</span><span style="color:#39ADB5;">%/*}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">http://www.baidu.com</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 查找替换</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># echo $url</span></span>
<span class="line"><span style="color:#E2931D;">http://www.baidu.com/index.html</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># echo </span><span style="color:#39ADB5;">\${</span><span style="color:#90A4AE;">url</span><span style="color:#39ADB5;">/</span><span style="color:#90A4AE;">baidu</span><span style="color:#39ADB5;">/</span><span style="color:#90A4AE;">taobao</span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#E2931D;">http://www.taobao.com/index.html</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># echo </span><span style="color:#39ADB5;">\${</span><span style="color:#90A4AE;">url</span><span style="color:#39ADB5;">/</span><span style="color:#90A4AE;">w</span><span style="color:#39ADB5;">/</span><span style="color:#90A4AE;">2</span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#E2931D;">http://2ww.baidu.com/index.html</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># echo </span><span style="color:#39ADB5;">\${</span><span style="color:#90A4AE;">url</span><span style="color:#39ADB5;">//</span><span style="color:#90A4AE;">w</span><span style="color:#39ADB5;">/</span><span style="color:#90A4AE;">2</span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#E2931D;">http://222.baidu.com/index.html</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 查找删除</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># echo $url</span></span>
<span class="line"><span style="color:#E2931D;">http://www.baidu.com/index.html</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># echo </span><span style="color:#39ADB5;">\${</span><span style="color:#90A4AE;">url</span><span style="color:#39ADB5;">/</span><span style="color:#90A4AE;">w</span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#E2931D;">http://ww.baidu.com/index.html</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># echo </span><span style="color:#39ADB5;">\${</span><span style="color:#90A4AE;">url</span><span style="color:#39ADB5;">//</span><span style="color:#90A4AE;">w</span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#E2931D;">http://.baidu.com/index.html</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 大小写转换</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># echo $url</span></span>
<span class="line"><span style="color:#E2931D;">http://www.baidu.com/index.html</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># echo </span><span style="color:#39ADB5;">\${</span><span style="color:#90A4AE;">url^</span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#E2931D;">Http://www.baidu.com/index.html</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># echo </span><span style="color:#39ADB5;">\${</span><span style="color:#90A4AE;">url^^</span><span style="color:#39ADB5;">}</span></span>
<span class="line"><span style="color:#E2931D;">HTTP://WWW.BAIDU.COM/INDEX.HTML</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 转换成小写</span></span>
<span class="line"><span style="color:#39ADB5;">\${</span><span style="color:#90A4AE;">url,,</span><span style="color:#39ADB5;">}</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br></div></div></details><h2 id="_3-求10个随机数的最大值与最小值。" tabindex="-1">3. 求10个随机数的最大值与最小值。 <a class="header-anchor" href="#_3-求10个随机数的最大值与最小值。" aria-label="Permalink to &quot;3. 求10个随机数的最大值与最小值。&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;">#!/usr/bin/bash</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 生成10个随机数，并找出其中的最大值和最小值</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9C3EDA;">declare</span><span style="color:#91B859;"> -a</span><span style="color:#90A4AE;"> arr</span></span>
<span class="line"><span style="color:#9C3EDA;">declare</span><span style="color:#91B859;"> -i</span><span style="color:#90A4AE;"> min</span></span>
<span class="line"><span style="color:#9C3EDA;">declare</span><span style="color:#91B859;"> -i</span><span style="color:#90A4AE;"> max</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">for</span><span style="color:#90A4AE;"> i </span><span style="color:#39ADB5;font-style:italic;">in</span><span style="color:#39ADB5;"> {</span><span style="color:#E2931D;">0..9}</span><span style="color:#39ADB5;">;</span><span style="color:#39ADB5;font-style:italic;"> do</span></span>
<span class="line"><span style="color:#90A4AE;">        arr</span><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">i</span><span style="color:#39ADB5;">]=</span><span style="color:#90A4AE;">$RANDOM</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">        if</span><span style="color:#39ADB5;"> [[</span><span style="color:#90A4AE;"> $i </span><span style="color:#39ADB5;">-eq</span><span style="color:#F76D47;"> 0</span><span style="color:#39ADB5;"> ]];</span><span style="color:#39ADB5;font-style:italic;"> then</span></span>
<span class="line"><span style="color:#90A4AE;">                min</span><span style="color:#39ADB5;">=\${</span><span style="color:#90A4AE;">arr</span><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">i</span><span style="color:#39ADB5;">]}</span></span>
<span class="line"><span style="color:#90A4AE;">                max</span><span style="color:#39ADB5;">=\${</span><span style="color:#90A4AE;">arr</span><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">i</span><span style="color:#39ADB5;">]}</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">        elif</span><span style="color:#39ADB5;"> [[</span><span style="color:#39ADB5;"> \${</span><span style="color:#90A4AE;">arr</span><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">i</span><span style="color:#39ADB5;">]}</span><span style="color:#39ADB5;"> -lt</span><span style="color:#90A4AE;"> $min </span><span style="color:#39ADB5;">]];</span><span style="color:#39ADB5;font-style:italic;"> then</span></span>
<span class="line"><span style="color:#90A4AE;">                min</span><span style="color:#39ADB5;">=\${</span><span style="color:#90A4AE;">arr</span><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">i</span><span style="color:#39ADB5;">]}</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">        else</span></span>
<span class="line"><span style="color:#90A4AE;">                max</span><span style="color:#39ADB5;">=\${</span><span style="color:#90A4AE;">arr</span><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">i</span><span style="color:#39ADB5;">]}</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">        fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">done</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6182B8;">echo</span><span style="color:#91B859;"> min:</span><span style="color:#90A4AE;"> $min</span></span>
<span class="line"><span style="color:#6182B8;">echo</span><span style="color:#91B859;"> max:</span><span style="color:#90A4AE;"> $max</span></span>
<span class="line"><span style="color:#6182B8;">echo</span><span style="color:#91B859;"> arr:</span><span style="color:#39ADB5;"> &quot;\${</span><span style="color:#90A4AE;">arr</span><span style="color:#39ADB5;">[@]}&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">arr:</span><span style="color:#F76D47;"> 30824</span><span style="color:#F76D47;"> 9382</span><span style="color:#F76D47;"> 15471</span><span style="color:#F76D47;"> 22226</span><span style="color:#F76D47;"> 4068</span><span style="color:#F76D47;"> 29362</span><span style="color:#F76D47;"> 5154</span><span style="color:#F76D47;"> 20267</span><span style="color:#F76D47;"> 5611</span><span style="color:#F76D47;"> 5653</span></span>
<span class="line"><span style="color:#E2931D;">min:</span><span style="color:#F76D47;"> 4068</span></span>
<span class="line"><span style="color:#E2931D;">max:</span><span style="color:#F76D47;"> 5653</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br></div></div><h2 id="_4-使用递归调用-完成阶乘算法实现。" tabindex="-1">4. 使用递归调用，完成阶乘算法实现。 <a class="header-anchor" href="#_4-使用递归调用-完成阶乘算法实现。" aria-label="Permalink to &quot;4. 使用递归调用，完成阶乘算法实现。&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6182B8;">read</span><span style="color:#91B859;"> -p</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">Num:</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;"> num</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">result</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">1</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">for</span><span style="color:#90A4AE;"> i </span><span style="color:#39ADB5;font-style:italic;">in</span><span style="color:#39ADB5;"> $(</span><span style="color:#E2931D;">seq</span><span style="color:#90A4AE;"> $num</span><span style="color:#39ADB5;">);</span><span style="color:#39ADB5;font-style:italic;"> do</span></span>
<span class="line"><span style="color:#90A4AE;">        result</span><span style="color:#39ADB5;">=$((</span><span style="color:#90A4AE;">$result </span><span style="color:#39ADB5;">*</span><span style="color:#90A4AE;"> $i</span><span style="color:#39ADB5;">))</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">done</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6182B8;">echo</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">The result is:</span><span style="color:#39ADB5;">&quot;</span><span style="color:#90A4AE;"> $result</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="_3-解析进程和线程的区别" tabindex="-1">3. 解析进程和线程的区别？ <a class="header-anchor" href="#_3-解析进程和线程的区别" aria-label="Permalink to &quot;3. 解析进程和线程的区别？&quot;">​</a></h2><p><strong>进程</strong></p><p>进程是一个具有独立功能的程序在一个数据集上的一次动态执行过程，是操作系统进行资源分配和调度的一个独立单位，是应用程序运行的载体。进程是一种抽象的概念，从来没有统一的标准定义。</p><p>进程一般由程序，数据集合和进程控制块三部分组成。</p><p>进程具有的特性：</p><p>动态性：进程是程序的一次执行过程，是临时的，有生命期，是动态产生，动态消亡。<br> 并发性：任何进程可以同其他进程一起并发执行。<br> 独立性：进程是系统进行资源分配和调度的一个独立单位。<br> 结构性：进程一般由程序，数据集合和进程控制块三部分组成</p><p><strong>线程</strong>：</p><p>线程是程序执行中一个单一的顺序控制流，是程序执行流的最小单位，是处理器调度和分派的基本单位，一个进程可以有一个或多个线程，各线程之前共享程序的内存空间。一个标准的线程由线程ID，当前指令指针PC,寄存器和堆栈组成。</p><h2 id="_4-解析进程的结构。" tabindex="-1">4. 解析进程的结构。 <a class="header-anchor" href="#_4-解析进程的结构。" aria-label="Permalink to &quot;4. 解析进程的结构。&quot;">​</a></h2><ol><li>程序段（代码段）：进程的程序段是可执行文件的内容，它包含了进程的代码和常量数据。</li><li>数据段：数据段是进程所需的数据存储区域，包括全局变量、静态变量和常量等数据。</li><li>堆区：堆区是动态分配内存的区域，程序可以在运行时申请和释放堆内存。</li><li>栈区：栈区用于存储局部变量和程序调用栈信息，随着函数的调用和返回，栈区的大小会动态变化。</li><li>进程控制块（Process Control Block，PCB）：进程控制块是操作系统中用来描述和管理进程的数据结构，它包含了进程的状态、优先级、PID（进程标识符）、所属用户等信息，以及进程的资源占用情况、CPU寄存器状态、堆栈指针等上下文信息。</li><li>系统资源：进程需要操作系统提供的各种资源，如内存、文件、输入输出设备等。</li></ol><h2 id="_5-解析磁盘中的代码如何在计算机上运行的" tabindex="-1">5. 解析磁盘中的代码如何在计算机上运行的？ <a class="header-anchor" href="#_5-解析磁盘中的代码如何在计算机上运行的" aria-label="Permalink to &quot;5. 解析磁盘中的代码如何在计算机上运行的？&quot;">​</a></h2><p>本身程序是在硬盘上，启动程序之后，操作系统会开辟一个进程（一定的内存空间），然后将程序加载进内存，加载进内存的程序都是二进制文件。cpu通过寄存器拿到内存中的数据进行处理，处理完之后再将数据通过寄存器交给内存。</p><h2 id="_6-总结oom原理-及处理方法。" tabindex="-1">6. 总结OOM原理，及处理方法。 <a class="header-anchor" href="#_6-总结oom原理-及处理方法。" aria-label="Permalink to &quot;6. 总结OOM原理，及处理方法。&quot;">​</a></h2><p>OOM, 全称 “Out Of Memory”, 意思是 “内存用完了”</p><p>具体原因大致为两方面:</p><ul><li>自身原因: 比如虚拟机本身可使用的内存太少。</li><li>外在原因: 如应用使用的太多, 且用完没释放, 浪费了内存。此时就会造成内存泄露或者内存溢出。</li></ul><p>OOM原理：程序在运行时需要申请一定的内存空间，如果可用内存空间不足以满足程序需求，则操作系统就会报告OOM错误。该错误通常在程序运行时被检测到，导致程序异常终止。</p><p>处理方法：</p><ol><li><p>优化内存使用：在代码中避免使用大量的内存，尽量减少内存泄漏的发生。</p></li><li><p>增加内存：如果程序需要处理的数据量很大，可以考虑增加系统的内存。</p></li><li><p>分批处理数据：将大量数据分成小批量处理，避免一次性加载所有数据导致内存不足。</p></li><li><p>使用虚拟内存：虚拟内存是一种将磁盘空间作为内存使用的技术，可以将一部分内存数据存储到磁盘上，从而扩大可用内存。</p></li><li><p>使用内存映射文件：内存映射文件是一种将磁盘文件映射到内存地址空间的技术，可以降低内存的占用。</p></li><li><p>使用垃圾回收机制：垃圾回收机制可以自动回收不再使用的内存，避免内存泄漏的发生。</p></li><li><p>使用压缩算法：对于一些数据量较大的数据，可以使用压缩算法进行压缩，降低内存的使用。</p></li><li><p>使用缓存：使用缓存可以将经常使用的数据保存在内存中，避免频繁地从磁盘读取数据。</p></li><li><p>使用64位操作系统：64位操作系统可以支持更大的内存地址空间，可以解决一些内存不足的问题。</p></li></ol><p>总之，避免OOM错误的关键在于优化内存使用，尽量减少内存泄漏的发生，并采取合适的处理方法。</p><h2 id="_7-结合进程管理命令-说明进程各种状态。" tabindex="-1">7. 结合进程管理命令，说明进程各种状态。 <a class="header-anchor" href="#_7-结合进程管理命令-说明进程各种状态。" aria-label="Permalink to &quot;7. 结合进程管理命令，说明进程各种状态。&quot;">​</a></h2><p>进程状态</p><p>创建：进程在创建时需要申请一个空白的PCB，向其中填写控制和管理进程的信息，完成资源分配，如果创建无法完成，如资源不足，此时进程处于创建状态。</p><p>就绪：进程已准备好，已分配到所需资源，只要分配到CPU时间片就可立即执行</p><p>执行：进程处于就绪后被调用，进入执行状态</p><p>阻塞：正在执行的进程由于进行I/O请求而等待I/O的完成暂时无法继续运行，进入阻塞状态</p><p>终止：进程运行结束，或出现错误，或被系统终止</p><p>ps命令输出中进程的状态：</p><p>运行：running</p><p>就绪：ready</p><p>睡眠：分两种，可中断（interruptable）和不可中断（uninterruptable）</p><p>停止：stopped，暂停于内存，但不会被调度，除非手动启动</p><p>僵死：zombie，父进程结束前，子进程不关闭，杀死父进程可关闭僵死进程的子进程。</p><h2 id="_8-说明ipc通信和rpc通信实现的方式。" tabindex="-1">8. 说明IPC通信和RPC通信实现的方式。 <a class="header-anchor" href="#_8-说明ipc通信和rpc通信实现的方式。" aria-label="Permalink to &quot;8. 说明IPC通信和RPC通信实现的方式。&quot;">​</a></h2><p>IPC（Inter-Process Communication）与RPC（Remote Procedure Call）用于实现跨进程通信。只不过IPC一般用于一台机器内部不同进程之间的通信，RPC用于不同机器间的进程调用通信。</p><p>IPC常见的是共享内存来通信，RPC是通过通信来调用远程机器上的函数或者方法。</p><div class="tip custom-block"><p class="custom-block-title">IPC的实现方式</p><ol><li>管道（Pipe） 管道是一种半双工的通信方式，只能在具有亲缘关系（如父子进程）的进程之间进行通信。管道是由操作系统内核创建的一段缓冲区，可以存放一定量的数据。数据写入管道后可以在另一个进程中被读取，管道的实现方式包括匿名管道和命名管道两种。</li><li>消息队列（Message Queue） 消息队列是一种进程间的异步通信方式，它允许一个进程向另一个进程发送消息，消息包括类型和数据。消息队列可以在不同进程之间共享，接收者可以按照消息类型选择接收哪些消息。</li><li>共享内存（Shared Memory） 共享内存是一种高效的进程间通信方式，它允许多个进程访问同一块内存区域，共享内存中的数据可以被所有进程访问和修改。共享内存的实现需要考虑同步和互斥问题，以保证数据的一致性。</li><li>信号量（Semaphore） 信号量是一种计数器，用于进程间的同步和互斥。它允许多个进程对共享资源进行访问，但只允许一个进程访问资源的特定部分。信号量主要用于解决多进程之间的互斥问题。</li><li>套接字（Socket） 套接字是一种通用的进程间通信方式，它可以用于不同机器和不同操作系统之间的通信。套接字通信可以在同一台计算机上的不同进程之间进行，也可以在不同计算机之间进行，是实现网络通信的基础。</li><li>信号（Signal） 信号是一种异步通信方式，用于向进程发送通知。当操作系统检测到某个事件发生时，会向进程发送相应的信号，进程可以在信号处理函数中处理信号。信号通常用于进程间的事件通知和错误处理。</li></ol></div><div class="tip custom-block"><p class="custom-block-title">RPC的实现方式</p><ol><li>基于HTTP协议的RPC HTTP协议是一种广泛使用的应用层协议，它是基于TCP协议实现的，可以实现可靠的数据传输和通信。基于HTTP协议的RPC通常使用JSON或XML格式进行数据传输，客户端通过发送HTTP请求到服务器来调用远程方法，服务器返回响应结果。</li><li>基于TCP/IP协议的RPC TCP/IP协议是一种面向连接的协议，它可以实现可靠的数据传输和通信。基于TCP/IP协议的RPC通常使用二进制格式进行数据传输，客户端通过建立TCP连接到服务器来调用远程方法，服务器返回响应结果。</li><li>基于UDP协议的RPC UDP协议是一种无连接的协议，它可以实现高效的数据传输和通信，但不保证数据的可靠性和顺序性。基于UDP协议的RPC通常使用二进制格式进行数据传输，客户端通过发送UDP包到服务器来调用远程方法，服务器返回响应结果。</li><li>基于序列化框架的RPC</li></ol><p>序列化框架是一种将对象序列化为字节流的机制，可以实现对象的持久化和网络传输。基于序列化框架的RPC通常使用Java序列化或Protobuf等框架进行数据传输，客户端通过发送序列化后的数据到服务器来调用远程方法，服务器返回响应结果</p></div><h2 id="_9-通过mkfifo-cat-来解释秒杀的并发问题-如何通过队列解决的-最好结合图形。说明消息队列的作用" tabindex="-1">9. 通过mkfifo, cat, 来解释秒杀的并发问题，如何通过队列解决的？最好结合图形。说明消息队列的作用？ <a class="header-anchor" href="#_9-通过mkfifo-cat-来解释秒杀的并发问题-如何通过队列解决的-最好结合图形。说明消息队列的作用" aria-label="Permalink to &quot;9. 通过mkfifo, cat, 来解释秒杀的并发问题，如何通过队列解决的？最好结合图形。说明消息队列的作用？&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;"># 客户端，100个线程发送1万个消息到通道中</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># cat client.sh </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">for</span><span style="color:#90A4AE;"> i </span><span style="color:#39ADB5;font-style:italic;">in</span><span style="color:#39ADB5;"> {</span><span style="color:#E2931D;">1..100}</span><span style="color:#39ADB5;">;</span><span style="color:#39ADB5;font-style:italic;">do</span></span>
<span class="line"><span style="color:#39ADB5;">   (</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">      for</span><span style="color:#90A4AE;"> j </span><span style="color:#39ADB5;font-style:italic;">in</span><span style="color:#39ADB5;"> {</span><span style="color:#E2931D;">1..10000}</span><span style="color:#39ADB5;">;</span><span style="color:#39ADB5;font-style:italic;">do</span></span>
<span class="line"><span style="color:#6182B8;">         echo</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#90A4AE;">$i</span><span style="color:#91B859;">=&gt;</span><span style="color:#90A4AE;">$j</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;"> &gt;&gt;</span><span style="color:#91B859;"> /data/task</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">      done</span></span>
<span class="line"><span style="color:#90A4AE;">   )</span><span style="color:#39ADB5;">&amp;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">done</span></span>
<span class="line"><span style="color:#6182B8;">echo</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">all client are start...</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"><span style="color:#6182B8;">wait</span></span>
<span class="line"><span style="color:#6182B8;">echo</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">all client are done...</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 服务器端，消息符合target的消息才会被获取</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># cat server.sh </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">#!/bin/bash</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">fifo</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">/data/task</span></span>
<span class="line"><span style="color:#90A4AE;">target</span><span style="color:#39ADB5;">=$((</span><span style="color:#90A4AE;">$RANDOM%10000</span><span style="color:#39ADB5;">))</span></span>
<span class="line"><span style="color:#6182B8;">echo</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#90A4AE;">$target</span><span style="color:#91B859;"> is target.</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">while</span><span style="color:#6182B8;"> true</span><span style="color:#39ADB5;">;</span><span style="color:#39ADB5;font-style:italic;">do</span></span>
<span class="line"><span style="color:#E2931D;">   cat</span><span style="color:#91B859;"> /data/task</span><span style="color:#39ADB5;"> |</span><span style="color:#39ADB5;font-style:italic;"> while</span><span style="color:#6182B8;"> read</span><span style="color:#91B859;"> line</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">   do</span></span>
<span class="line"><span style="color:#90A4AE;">      server</span><span style="color:#39ADB5;">=</span><span style="color:#39ADB5;">\`</span><span style="color:#6182B8;">echo</span><span style="color:#90A4AE;"> $line</span><span style="color:#39ADB5;"> |</span><span style="color:#E2931D;"> awk</span><span style="color:#91B859;"> -F </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">=&gt;</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;"> &#39;</span><span style="color:#91B859;">{print $1}</span><span style="color:#39ADB5;">&#39;\`</span></span>
<span class="line"><span style="color:#90A4AE;">      client</span><span style="color:#39ADB5;">=</span><span style="color:#39ADB5;">\`</span><span style="color:#6182B8;">echo</span><span style="color:#90A4AE;"> $line</span><span style="color:#39ADB5;"> |</span><span style="color:#E2931D;"> awk</span><span style="color:#91B859;"> -F </span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">=&gt;</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;"> &#39;</span><span style="color:#91B859;">{print $2}</span><span style="color:#39ADB5;">&#39;\`</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">      if</span><span style="color:#39ADB5;"> [</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#90A4AE;">$client</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;"> -eq</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#90A4AE;">$target</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;"> ];</span><span style="color:#39ADB5;font-style:italic;">then</span></span>
<span class="line"><span style="color:#6182B8;">         echo</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">server is </span><span style="color:#90A4AE;">$server</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">      fi</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">   done</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">done</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 结果</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost data</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># bash  server.sh </span></span>
<span class="line"><span style="color:#E2931D;">8024</span><span style="color:#91B859;"> is</span><span style="color:#91B859;"> target.</span></span>
<span class="line"><span style="color:#E2931D;">server</span><span style="color:#91B859;"> is</span><span style="color:#F76D47;"> 22</span></span>
<span class="line"><span style="color:#E2931D;">server</span><span style="color:#91B859;"> is</span><span style="color:#F76D47;"> 26</span></span>
<span class="line"><span style="color:#E2931D;">server</span><span style="color:#91B859;"> is</span><span style="color:#F76D47;"> 15</span></span>
<span class="line"><span style="color:#E2931D;">server</span><span style="color:#91B859;"> is</span><span style="color:#F76D47;"> 85</span></span>
<span class="line"><span style="color:#E2931D;">server</span><span style="color:#91B859;"> is</span><span style="color:#F76D47;"> 25</span></span>
<span class="line"><span style="color:#E2931D;">server</span><span style="color:#91B859;"> is</span><span style="color:#F76D47;"> 83</span></span>
<span class="line"><span style="color:#E2931D;">server</span><span style="color:#91B859;"> is</span><span style="color:#F76D47;"> 41</span></span>
<span class="line"><span style="color:#E2931D;">server</span><span style="color:#91B859;"> is</span><span style="color:#F76D47;"> 5</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br></div></div><blockquote><p>如上所示，只有当消息队列中的消息满足条件的才会被获取并往后传递，在秒杀系统中，并不能把所有的读写往数据库上压，过于巨大的流量会瞬间压垮数据库，只有在前端限流，将流量过滤传递到数据库才能保障数据库的安全，上面的脚本中，一共有10万个消息传递到1个消息队列中，通过对消息队列的读取，过滤，限流，将中奖的消息往后传递，这样数据库压力几乎没有。</p></blockquote><h2 id="_10-总结linux-前台和后台作业的区别-并说明如何在前台和后台中进行状态转换。" tabindex="-1">10. 总结Linux，前台和后台作业的区别，并说明如何在前台和后台中进行状态转换。 <a class="header-anchor" href="#_10-总结linux-前台和后台作业的区别-并说明如何在前台和后台中进行状态转换。" aria-label="Permalink to &quot;10. 总结Linux，前台和后台作业的区别，并说明如何在前台和后台中进行状态转换。&quot;">​</a></h2><p>前台进程：是在终端中运行的命令，那么该终端就为进程的控制终端，一旦这个终端关闭，这个进程也随之消失。</p><p>后台进程：也叫守护进程（Daemon），是运行在后台的一种特殊进程，不受终端控制，它不需要终端的交互；Linux的大多数服务器就是使用守护进程实现的。比如Web服务器的httpd等。</p><p>CTRL+z：将正在运行的程序放置后台停止，以便终端的继续使用</p><p>jobs：查看后台停止的程序</p><p>bg +1：将后台停止状态的进程，变成后台运行的程序</p><p>fg：将后台运行的程序放置前台运行</p><h2 id="_11-总结内核设计流派及特点。" tabindex="-1">11. 总结内核设计流派及特点。 <a class="header-anchor" href="#_11-总结内核设计流派及特点。" aria-label="Permalink to &quot;11. 总结内核设计流派及特点。&quot;">​</a></h2><p>操作系统内核的设计流派主要分为两种：宏内核（Microkernel）和单内核（Monolithic Kernel）。</p><p>1.宏内核（Microkernel） 宏内核是一种将操作系统内核中的大部分功能模块化的设计方式，将操作系统内核分成多个组件或服务，仅保留最基本的内核服务，例如内存管理、进程管理、线程管理、IPC等。 其主要特点是：</p><ul><li>将操作系统内核分成多个组件或服务，可以实现高度模块化的设计，方便添加、移除和修改功能。</li><li>在安全性和可靠性方面有一定的优势，因为每个组件只负责一个特定的功能，独立运行，出现问题时不会影响其他组件。</li><li>可以支持多种操作系统架构，例如分布式系统、实时系统等。</li><li>性能相对较低，因为需要经常进行进程间通信（IPC）。</li></ul><p>2.单内核（Monolithic Kernel） 单内核是将所有操作系统内核服务集成在一个单独的大内核中，包括内存管理、进程管理、文件系统、网络协议栈等。 其主要特点是：</p><ul><li>所有的内核服务都在一个单独的大内核中，可以实现高效的内部通信，提高系统性能。</li><li>简单、易于实现，因为所有的内核服务都在一个单独的大内核中，代码量相对较小，便于维护和修改。</li><li>可以提供更高的性能，因为不需要经常进行进程间通信（IPC）。</li><li>安全性和可靠性较差，因为所有的内核服务都在同一个进程中，出现问题时可能会导致整个系统崩溃。 总之，宏内核和单内核各有优劣，需要根据具体的需求和设计要求选择合适的设计流派。在实际的操作系统中，也有许多混合型的内核设计，如微内核（Hybrid Kernel）、外核（Exokernel）等。这些设计都是为了在保证高性能和高可用性的前提下，提高操作系统的可扩展性和灵活性。</li></ul><h2 id="_12-总结centos-6-启动流程-grub工作流程" tabindex="-1">12. 总结centos 6 启动流程，grub工作流程 <a class="header-anchor" href="#_12-总结centos-6-启动流程-grub工作流程" aria-label="Permalink to &quot;12. 总结centos 6 启动流程，grub工作流程&quot;">​</a></h2><p><strong>Centos 6 启动流程</strong></p><p>POST 加电自检---〉MBR 引导 ---〉GRUB ---〉加载内核</p><ol><li>POST加电自检,即加载BIOS的硬件信息，获取第一个启动设备</li><li>读取第一个启动设备MBR的引导加载程序(grub)的启动信息</li><li>加载核心操作系统的核心信息，核心开始解压缩，并尝试驱动所有的硬件设备</li><li>核心执行init程序，并获取默认的运行信息</li><li>init程序执行/etc/rc.d/rc.sysinit文件</li><li>启动核心的外挂模块</li><li>init执行运行的各个批处理文件(scripts)</li><li>执行/bin/login程序，等待用户登录</li><li>登录之后开始以Shell控制主机启动流程</li></ol><p><strong>grub</strong> 工作流程<br> GRUB的作用是为了引导并加载kernel，要加载kernel首先得找到kernel所在的路径，因此首先就得有文件系统，要有文件系统首先要加载文件系统驱动，而文件系统驱动文件的大小远大于446字节（大约400+KB），而MBR之后的扇区可以存放一部分文件系统驱动，此时加载的文件系统驱动是grub2阶段所需文件（/boot下文件）需要的文件系统驱动，此时就可以使用/boot/grub/grub.conf，此配置文件中定义了kernel文件的位置，然后就可以加载kernel。</p><h2 id="_13-手写chkconfig服务脚本-可以实现服务的开始-停止-重启。" tabindex="-1">13. 手写chkconfig服务脚本，可以实现服务的开始，停止，重启。 <a class="header-anchor" href="#_13-手写chkconfig服务脚本-可以实现服务的开始-停止-重启。" aria-label="Permalink to &quot;13. 手写chkconfig服务脚本，可以实现服务的开始，停止，重启。&quot;">​</a></h2><blockquote><p>chkconfig提供一种简单的命令行工具来帮助管理员对/etc/rc[0-6].d目录层次下的众多的符号链接进行直接操作</p></blockquote><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;"># 在/etc/rc.d/init.d目录下创建shell脚本，文件名auto_run</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">#!/bin/sh</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">#chkconfig: 2345 80 90</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">#description:auto_run</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># chkconfig后面有三个参数2345,80和90告诉chkconfig程序，需要在rc2.d~rc5.d目录下，创建名字为 S80auto_run的文件连接，</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 连接到/etc/rc.d/init.d目录下的的auto_run脚本。</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 第一个字符是S，系统在启动的时候，运行脚本auto_run，就会添加一个start参数，告诉脚本，现在是启动模式。</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 同时在rc0.d和rc6.d目录下，创建名字为K90auto_run的文件连接，第一个字符为K，系统在关闭系统的时候，会运行auto_run，</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 添加一个stop，告诉脚本，现在是关闭模式。</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><details class="details custom-block"><summary>手写的Nginx服务脚本示例</summary><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;">#!/bin/bash</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># chkconfig: 2345 99 20</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># description: Ningx Server Control Scripts shell</span></span>
<span class="line"><span style="color:#90A4AE;">PROG</span><span style="color:#39ADB5;">=</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">/data/app/nginx/sbin/nginx</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"><span style="color:#90A4AE;">PIDF</span><span style="color:#39ADB5;">=</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">/data/log/nginx/nginx.pid</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">case</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#90A4AE;font-style:italic;">$1</span><span style="color:#39ADB5;">&quot;</span><span style="color:#39ADB5;font-style:italic;"> in</span></span>
<span class="line"><span style="color:#91B859;">  start</span><span style="color:#39ADB5;">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">    if</span><span style="color:#39ADB5;"> [</span><span style="color:#39ADB5;"> -f</span><span style="color:#90A4AE;"> $PIDF </span><span style="color:#39ADB5;">];</span><span style="color:#39ADB5;font-style:italic;">then</span></span>
<span class="line"></span>
<span class="line"><span style="color:#6182B8;">      echo</span><span style="color:#91B859;"> -e</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">Nginx is running...                  [\\033[31m失败\\033[0m]</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">    else</span></span>
<span class="line"><span style="color:#90A4AE;">      $PROG</span></span>
<span class="line"><span style="color:#6182B8;">      echo</span><span style="color:#91B859;"> -e</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">Nginx start...                       [\\033[32m成功\\033[0m]</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">    fi</span></span>
<span class="line"><span style="color:#39ADB5;">  ;;</span></span>
<span class="line"><span style="color:#91B859;">  stop</span><span style="color:#39ADB5;">)</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">    if</span><span style="color:#39ADB5;"> [</span><span style="color:#39ADB5;"> -f</span><span style="color:#90A4AE;"> $PIDF </span><span style="color:#39ADB5;">];</span><span style="color:#39ADB5;font-style:italic;">then</span></span>
<span class="line"><span style="color:#90A4AE;">      $PROG </span><span style="color:#91B859;">-s</span><span style="color:#91B859;"> stop</span></span>
<span class="line"><span style="color:#6182B8;">      echo</span><span style="color:#91B859;"> -e</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">Nginx stop...                        [\\033[32m成功\\033[0m]</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"><span style="color:#E2931D;">      rm</span><span style="color:#91B859;"> -f</span><span style="color:#90A4AE;"> $PIDF</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">    else</span></span>
<span class="line"><span style="color:#6182B8;">      echo</span><span style="color:#91B859;"> -e</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">Nginx is already stopped...          [\\033[31m失败\\033[0m]</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">    fi</span></span>
<span class="line"><span style="color:#39ADB5;">  ;;</span></span>
<span class="line"><span style="color:#91B859;">  restart</span><span style="color:#39ADB5;">)</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">    $0</span><span style="color:#91B859;"> stop</span></span>
<span class="line"><span style="color:#E2931D;">    sleep</span><span style="color:#F76D47;"> 1</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">    $0</span><span style="color:#91B859;"> start</span></span>
<span class="line"><span style="color:#39ADB5;">  ;;</span></span>
<span class="line"><span style="color:#91B859;">  reload</span><span style="color:#39ADB5;">)</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">    if</span><span style="color:#39ADB5;"> [</span><span style="color:#39ADB5;"> -f</span><span style="color:#90A4AE;"> $PIDF </span><span style="color:#39ADB5;">];</span><span style="color:#39ADB5;font-style:italic;">then</span></span>
<span class="line"><span style="color:#90A4AE;">      $PROG </span><span style="color:#91B859;">-s</span><span style="color:#91B859;"> reload</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">    else</span></span>
<span class="line"><span style="color:#6182B8;">      echo</span><span style="color:#91B859;"> -e</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">Error: Nginx is stopped...           [\\033[31m失败\\033[0m]</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">    fi</span></span>
<span class="line"><span style="color:#39ADB5;">  ;;</span></span>
<span class="line"><span style="color:#91B859;">  status</span><span style="color:#39ADB5;">)</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">    if</span><span style="color:#39ADB5;"> [</span><span style="color:#39ADB5;"> -f</span><span style="color:#90A4AE;"> $PIDF </span><span style="color:#39ADB5;">];</span><span style="color:#39ADB5;font-style:italic;">then</span></span>
<span class="line"><span style="color:#6182B8;">      echo</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">Nginx is running.</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">    else</span></span>
<span class="line"><span style="color:#6182B8;">      echo</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">Nginx is stopped.</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">    fi</span></span>
<span class="line"><span style="color:#39ADB5;">  ;;</span></span>
<span class="line"><span style="color:#39ADB5;">  *)</span></span>
<span class="line"><span style="color:#6182B8;">    echo</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">Usage: </span><span style="color:#90A4AE;font-style:italic;">$0</span><span style="color:#91B859;"> (start|stop|restart|reload|status)</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"><span style="color:#6182B8;">    exit</span><span style="color:#F76D47;"> 1</span></span>
<span class="line"><span style="color:#39ADB5;font-style:italic;">esac</span></span>
<span class="line"><span style="color:#6182B8;">exit</span><span style="color:#F76D47;"> 0</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># nginx可执行权限</span></span>
<span class="line"><span style="color:#E2931D;">chmod</span><span style="color:#91B859;"> +x</span><span style="color:#91B859;"> /etc/init.d/nginx</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 添加nginx服务</span></span>
<span class="line"><span style="color:#E2931D;">chkconfig</span><span style="color:#91B859;"> --add</span><span style="color:#91B859;"> nginx</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 开机自启设置</span></span>
<span class="line"><span style="color:#E2931D;">chkconfig</span><span style="color:#91B859;"> nginx</span><span style="color:#91B859;"> on</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># nginx启动服务</span></span>
<span class="line"><span style="color:#E2931D;">/etc/init.d/nginx</span><span style="color:#91B859;"> start</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># nginx重启服务</span></span>
<span class="line"><span style="color:#E2931D;">/etc/init.d/nginx</span><span style="color:#91B859;"> restart</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># nginx停止服务</span></span>
<span class="line"><span style="color:#E2931D;">/etc/init.d/nginx</span><span style="color:#91B859;"> stop</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># nginx加载配置</span></span>
<span class="line"><span style="color:#E2931D;">/etc/init.d/nginx</span><span style="color:#91B859;"> reload</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br></div></div></details><h2 id="_14-总结systemd服务配置文件" tabindex="-1">14. 总结systemd服务配置文件 <a class="header-anchor" href="#_14-总结systemd服务配置文件" aria-label="Permalink to &quot;14. 总结systemd服务配置文件&quot;">​</a></h2><p>/usr/lib/systemd/system #每个服务最主要的启动脚本设置</p><p>/lib/systemd/system #ubuntu的对应目录，兼容于centOS7，8和Ubuntu</p><p>/run/systemd/system #系统执行过程中所产生的服务脚本，比上面目录优先运行</p><p>/etc/systemd/system #管理员创建的执行脚本</p><p><code>httpd</code> 配置文件</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost </span><span style="color:#39ADB5;">~]</span><span style="color:#90A4AE;"># systemctl cat httpd</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">Unit</span><span style="color:#39ADB5;">]</span></span>
<span class="line"><span style="color:#90A4AE;">Description</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">The</span><span style="color:#E2931D;"> Apache</span><span style="color:#91B859;"> HTTP</span><span style="color:#91B859;"> Server</span><span style="color:#90A4AE;font-style:italic;">      # 描述</span></span>
<span class="line"><span style="color:#90A4AE;">Wants</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">httpd-init.service</span><span style="color:#90A4AE;font-style:italic;">                # 在此服务启动之后还需启动什么服务，之后的服务启动失败不影响本服务</span></span>
<span class="line"><span style="color:#90A4AE;">After</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">network.target</span><span style="color:#E2931D;"> remote-fs.target</span><span style="color:#91B859;"> nss-lookup.target</span><span style="color:#91B859;"> httpd-init.service</span><span style="color:#90A4AE;font-style:italic;"> # 在哪些服务之后启动</span></span>
<span class="line"><span style="color:#90A4AE;">Documentation</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">man:httpd.service</span><span style="color:#39ADB5;">(</span><span style="color:#E2931D;">8</span><span style="color:#39ADB5;">)</span><span style="color:#90A4AE;font-style:italic;">      # 如何查看文档</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">Service</span><span style="color:#39ADB5;">]</span></span>
<span class="line"><span style="color:#90A4AE;">Type</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">notify</span><span style="color:#90A4AE;font-style:italic;">                             # 启动结束后会发出通知信号，然后 Systemd 再启动其他服务,详情在下面</span></span>
<span class="line"><span style="color:#90A4AE;">Environment</span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;">LANG</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">C</span><span style="color:#90A4AE;font-style:italic;">                      # 环境变量</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;">ExecStart</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">/usr/sbin/httpd</span><span style="color:#90A4AE;"> $OPTIONS </span><span style="color:#91B859;">-DFOREGROUND</span><span style="color:#90A4AE;font-style:italic;">  # 启动命令</span></span>
<span class="line"><span style="color:#90A4AE;">ExecReload</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">/usr/sbin/httpd</span><span style="color:#90A4AE;"> $OPTIONS </span><span style="color:#91B859;">-k</span><span style="color:#91B859;"> graceful</span><span style="color:#90A4AE;font-style:italic;">  # 重载配置文件命令</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># Send SIGWINCH for graceful stop</span></span>
<span class="line"><span style="color:#90A4AE;">KillSignal</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">SIGWINCH</span></span>
<span class="line"><span style="color:#90A4AE;">KillMode</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">mixed</span><span style="color:#90A4AE;font-style:italic;">                                   # 服务停止类型，默认control-group停止时杀死所有子进程，process只杀主进程，none只停止服务，不杀进程；</span></span>
<span class="line"><span style="color:#90A4AE;">PrivateTmp</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">true</span><span style="color:#90A4AE;font-style:italic;">                                  # 如果把PrivateTmp的值设置成true ，服务启动时会在/tmp目录下生成类似systemd-private-433ef27ba3d46d8aac286aeb1390e1b-apache.service-RedVyu的文件夹，用于存放apache的临时文件。</span></span>
<span class="line"></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">Install</span><span style="color:#39ADB5;">]</span></span>
<span class="line"><span style="color:#90A4AE;">WantedBy</span><span style="color:#39ADB5;">=</span><span style="color:#91B859;">multi-user.target</span><span style="color:#90A4AE;font-style:italic;">                        # 在什么级别启动</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br></div></div><h2 id="_15-总结system启动流程" tabindex="-1">15. 总结system启动流程 <a class="header-anchor" href="#_15-总结system启动流程" aria-label="Permalink to &quot;15. 总结system启动流程&quot;">​</a></h2><ul><li>UEF或BIOS初始化，运行POST开机自检</li><li>选择启动设备</li><li>引导装载程序，centOS7是grub2加载程序的配置文件：<br> /etc/grub.d/<br> /etc/default/grub<br> /boot/grub2/grub.cfg</li><li>加载initramfs驱动模块（可以实现根文件系统的挂载）</li><li>加载内核选项</li><li>内核初始化，centOS使用systemd代替init</li><li>执行initrd.target所有单元，包括挂载/etc/fstab</li><li>从initasmfs根文件系统切换到磁盘根目录</li><li>systemd执行默认target配置，配置文件/etc/systemd/system/default.target</li><li>systemd执行sysinit.target初始化系统及basic.target准备操作系统</li><li>systemd启动multi-user.target下的本机于服务器服务</li><li>systemd执行multi-user.target下的/etc/rc.d/rc.local</li><li>ststemd执行multi-user.target下的getty.target及登录服务</li><li>systemd执行graphical需要的服务</li></ul><h2 id="_16-总结awk工作原理-awk命令-选项-示例。" tabindex="-1">16. 总结awk工作原理，awk命令，选项，示例。 <a class="header-anchor" href="#_16-总结awk工作原理-awk命令-选项-示例。" aria-label="Permalink to &quot;16. 总结awk工作原理，awk命令，选项，示例。&quot;">​</a></h2><p><a href="/linux/awk#%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86" target="_blank">AWK工作原理</a></p><h2 id="_17-总结awk的数组-函数。" tabindex="-1">17. 总结awk的数组，函数。 <a class="header-anchor" href="#_17-总结awk的数组-函数。" aria-label="Permalink to &quot;17. 总结awk的数组，函数。&quot;">​</a></h2><p><a href="/linux/awk#%E6%95%B0%E7%BB%84" target="_blank">AWK数组和函数</a></p><h2 id="_18-总结ca管理相关的工具-根据使用场景总结示例。" tabindex="-1">18. 总结ca管理相关的工具，根据使用场景总结示例。 <a class="header-anchor" href="#_18-总结ca管理相关的工具-根据使用场景总结示例。" aria-label="Permalink to &quot;18. 总结ca管理相关的工具，根据使用场景总结示例。&quot;">​</a></h2><p>ca相当于中间人的角色</p><details class="details custom-block"><summary>示例</summary><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;"># 创建文件</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost </span><span style="color:#39ADB5;">~]</span><span style="color:#90A4AE;"># mkdir /etc/pki/CA/certs</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost </span><span style="color:#39ADB5;">~]</span><span style="color:#90A4AE;"># mkdir /etc/pki/CA/newcerts</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost </span><span style="color:#39ADB5;">~]</span><span style="color:#90A4AE;"># mkdir /etc/pki/CA/crl</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost </span><span style="color:#39ADB5;">~]</span><span style="color:#90A4AE;"># mkdir /etc/pki/CA/private</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost </span><span style="color:#39ADB5;">~]</span><span style="color:#90A4AE;"># tree /etc/pki/CA</span></span>
<span class="line"><span style="color:#E2931D;">/etc/pki/CA</span></span>
<span class="line"><span style="color:#E2931D;">├──</span><span style="color:#91B859;"> certs</span></span>
<span class="line"><span style="color:#E2931D;">├──</span><span style="color:#91B859;"> crl</span></span>
<span class="line"><span style="color:#E2931D;">├──</span><span style="color:#91B859;"> newcerts</span></span>
<span class="line"><span style="color:#E2931D;">└──</span><span style="color:#91B859;"> private</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 创建私有CA</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">#生成证书索引数据库文件</span></span>
<span class="line"><span style="color:#E2931D;">touch</span><span style="color:#91B859;"> /etc/pki/CA/index.txt</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">#指定第一个变法证书的序列号</span></span>
<span class="line"><span style="color:#6182B8;">echo</span><span style="color:#F76D47;"> 01</span><span style="color:#39ADB5;"> &gt;</span><span style="color:#91B859;"> /etx/pki/CA/serial</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 生成CA私钥</span></span>
<span class="line"><span style="color:#6182B8;">cd</span><span style="color:#91B859;"> /etc/pki/CA</span></span>
<span class="line"><span style="color:#39ADB5;">(</span><span style="color:#6182B8;">umask</span><span style="color:#F76D47;"> 066</span><span style="color:#39ADB5;">;</span><span style="color:#E2931D;">openssl</span><span style="color:#91B859;"> genrsa</span><span style="color:#91B859;"> -out</span><span style="color:#91B859;"> /private/cakey.pem</span><span style="color:#F76D47;"> 2048</span><span style="color:#39ADB5;">)</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 生成CA自签名证书</span></span>
<span class="line"><span style="color:#E2931D;">openssl</span><span style="color:#91B859;"> req</span><span style="color:#91B859;"> -new</span><span style="color:#91B859;"> -x509</span><span style="color:#91B859;"> -key</span><span style="color:#91B859;"> /etc/pki/CA/private/cakey.pem</span><span style="color:#91B859;"> -days</span><span style="color:#F76D47;"> 3650</span><span style="color:#91B859;"> -out</span><span style="color:#91B859;"> /etc/pki/CA/cacert.pem</span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">#选项说明</span></span>
<span class="line"><span style="color:#E2931D;">-new</span><span style="color:#91B859;"> :生成新证书签署请求</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">-x509:专用于CA生成自签证书</span></span>
<span class="line"><span style="color:#E2931D;">-key:生成请求时用到的私钥文件</span></span>
<span class="line"><span style="color:#E2931D;">-days</span><span style="color:#91B859;"> n:证书的有效期限</span></span>
<span class="line"><span style="color:#E2931D;">-out</span><span style="color:#91B859;"> /PATH/TO/SOMECERTFILE:证书的保存路径</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#E2931D;">国家代码：https://country-code.cl/</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 将生成的CA自签名证书变成可读</span></span>
<span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">root@localhost CA</span><span style="color:#39ADB5;">]</span><span style="color:#90A4AE;"># openssl x509 -in /etc/pki/CA/cacert.pem -noout -text</span></span>
<span class="line"><span style="color:#E2931D;">Certificate:</span></span>
<span class="line"><span style="color:#E2931D;">    Data:</span></span>
<span class="line"><span style="color:#E2931D;">        Version:</span><span style="color:#F76D47;"> 3</span><span style="color:#90A4AE;"> (0x2)</span></span>
<span class="line"><span style="color:#E2931D;">        Serial</span><span style="color:#91B859;"> Number:</span></span>
<span class="line"><span style="color:#E2931D;">            51:a7:af:51:f2:66:17:63:ac:a2:4d:7e:48:29:60:e8:e5:8a:ff:59</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">        Signature</span><span style="color:#91B859;"> Algorithm:</span><span style="color:#91B859;"> sha256WithRSAEncryption</span></span>
<span class="line"><span style="color:#E2931D;">        Issuer:</span><span style="color:#91B859;"> C</span><span style="color:#91B859;"> =</span><span style="color:#91B859;"> CN,</span><span style="color:#91B859;"> ST</span><span style="color:#91B859;"> =</span><span style="color:#91B859;"> shanghai,</span><span style="color:#91B859;"> L</span><span style="color:#91B859;"> =</span><span style="color:#91B859;"> shanghai,</span><span style="color:#91B859;"> O</span><span style="color:#91B859;"> =</span><span style="color:#91B859;"> magedu,</span><span style="color:#91B859;"> OU</span><span style="color:#91B859;"> =</span><span style="color:#91B859;"> xie1,</span><span style="color:#91B859;"> CN</span><span style="color:#91B859;"> =</span><span style="color:#91B859;"> ca.magedu.org,</span><span style="color:#91B859;"> emailAddress</span><span style="color:#91B859;"> =</span><span style="color:#91B859;"> admin@magedu.org</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">        Validity</span></span>
<span class="line"><span style="color:#E2931D;">            Not</span><span style="color:#91B859;"> Before:</span><span style="color:#91B859;"> Feb</span><span style="color:#F76D47;"> 16</span><span style="color:#91B859;"> 06:12:58</span><span style="color:#F76D47;"> 2023</span><span style="color:#91B859;"> GMT</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">            Not</span><span style="color:#91B859;"> After</span><span style="color:#91B859;"> :</span><span style="color:#91B859;"> Feb</span><span style="color:#F76D47;"> 13</span><span style="color:#91B859;"> 06:12:58</span><span style="color:#F76D47;"> 2033</span><span style="color:#91B859;"> GMT</span></span>
<span class="line"><span style="color:#E2931D;">        Subject:</span><span style="color:#91B859;"> C</span><span style="color:#91B859;"> =</span><span style="color:#91B859;"> CN,</span><span style="color:#91B859;"> ST</span><span style="color:#91B859;"> =</span><span style="color:#91B859;"> shanghai,</span><span style="color:#91B859;"> L</span><span style="color:#91B859;"> =</span><span style="color:#91B859;"> shanghai,</span><span style="color:#91B859;"> O</span><span style="color:#91B859;"> =</span><span style="color:#91B859;"> magedu,</span><span style="color:#91B859;"> OU</span><span style="color:#91B859;"> =</span><span style="color:#91B859;"> xie1,</span><span style="color:#91B859;"> CN</span><span style="color:#91B859;"> =</span><span style="color:#91B859;"> ca.magedu.org,</span><span style="color:#91B859;"> emailAddress</span><span style="color:#91B859;"> =</span><span style="color:#91B859;"> admin@magedu.org</span></span>
<span class="line"><span style="color:#E2931D;">        Subject</span><span style="color:#91B859;"> Public</span><span style="color:#91B859;"> Key</span><span style="color:#91B859;"> Info:</span></span>
<span class="line"><span style="color:#E2931D;">            Public</span><span style="color:#91B859;"> Key</span><span style="color:#91B859;"> Algorithm:</span><span style="color:#91B859;"> rsaEncryption</span></span>
<span class="line"><span style="color:#E2931D;">                Public-Key:</span><span style="color:#90A4AE;"> (2048 </span><span style="color:#91B859;">bit</span><span style="color:#90A4AE;">)</span></span>
<span class="line"><span style="color:#E2931D;">                Modulus:</span></span>
<span class="line"><span style="color:#E2931D;">                    00:cf:a9:99:0d:ac:a9:c0:d7:ba:05:7f:5e:ae:8c:</span></span>
<span class="line"><span style="color:#E2931D;">                    7b:d8:df:f4:3d:63:50:02:2d:1b:d9:b2:19:bb:e6:</span></span>
<span class="line"><span style="color:#E2931D;">                    c3:0d:20:49:62:1e:5a:d9:ae:a9:59:6d:c0:f4:f2:</span></span>
<span class="line"><span style="color:#E2931D;">                    38:74:af:8e:5d:43:d4:11:4d:6a:c7:4c:83:33:2e:</span></span>
<span class="line"><span style="color:#E2931D;">                    0d:ca:ce:b4:ea:25:d1:bd:46:32:a9:09:ef:ab:4d:</span></span>
<span class="line"><span style="color:#E2931D;">                    ae:d9:81:d2:9d:8c:9b:f2:80:7b:f1:e1:f1:23:0b:</span></span>
<span class="line"><span style="color:#E2931D;">                    2d:70:7b:29:28:14:51:4f:e2:c9:1a:ae:b5:ad:ea:</span></span>
<span class="line"><span style="color:#E2931D;">                    12:43:fb:8b:ef:e0:dd:fc:70:52:2d:59:fe:05:a3:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">                    dd:85:03:30:31:20:a8:41:41:13:d6:cc:ac:ae:ff:</span></span>
<span class="line"><span style="color:#E2931D;">                    e1:3a:4e:0f:cc:7a:85:a2:4a:ba:a4:e7:df:9b:d8:</span></span>
<span class="line"><span style="color:#E2931D;">                    0e:44:e4:e8:cd:f7:9c:c2:a8:b4:82:a5:3c:41:f2:</span></span>
<span class="line"><span style="color:#E2931D;">                    5e:31:d7:ef:c9:32:6e:0a:71:72:78:f7:31:f1:0b:</span></span>
<span class="line"><span style="color:#E2931D;">                    29:e4:b4:f9:ce:47:5e:09:c7:66:8a:d9:df:0e:4f:</span></span>
<span class="line"><span style="color:#E2931D;">                    64:6d:78:51:37:c6:ba:4f:27:ba:a8:30:89:5d:c8:</span></span>
<span class="line"><span style="color:#E2931D;">                    e3:8c:f4:75:9b:b8:61:8e:cd:5f:72:48:ea:6e:ab:</span></span>
<span class="line"><span style="color:#E2931D;">                    27:55:58:3f:f9:e7:1f:96:85:bb:af:a3:1f:a6:69:</span></span>
<span class="line"><span style="color:#E2931D;">                    b0:94:ad:30:62:9c:7e:a4:12:1e:2a:11:9d:03:d8:</span></span>
<span class="line"><span style="color:#E2931D;">                    b1:61</span></span>
<span class="line"><span style="color:#E2931D;">                Exponent:</span><span style="color:#F76D47;"> 65537</span><span style="color:#90A4AE;"> (0x10001)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">        X509v3</span><span style="color:#91B859;"> extensions:</span></span>
<span class="line"><span style="color:#E2931D;">            X509v3</span><span style="color:#91B859;"> Subject</span><span style="color:#91B859;"> Key</span><span style="color:#91B859;"> Identifier:</span></span>
<span class="line"><span style="color:#E2931D;">                E4:D1:82:D3:5C:F7:DB:22:A5:CF:FD:7A:23:FF:8A:D1:71:C9:E0:3D</span></span>
<span class="line"><span style="color:#E2931D;">            X509v3</span><span style="color:#91B859;"> Authority</span><span style="color:#91B859;"> Key</span><span style="color:#91B859;"> Identifier:</span></span>
<span class="line"><span style="color:#E2931D;">                E4:D1:82:D3:5C:F7:DB:22:A5:CF:FD:7A:23:FF:8A:D1:71:C9:E0:3D</span></span>
<span class="line"><span style="color:#E2931D;">            X509v3</span><span style="color:#91B859;"> Basic</span><span style="color:#91B859;"> Constraints:</span><span style="color:#91B859;"> critical</span></span>
<span class="line"><span style="color:#E2931D;">                CA:TRUE</span></span>
<span class="line"><span style="color:#E2931D;">    Signature</span><span style="color:#91B859;"> Algorithm:</span><span style="color:#91B859;"> sha256WithRSAEncryption</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">    Signature</span><span style="color:#91B859;"> Value:</span></span>
<span class="line"><span style="color:#E2931D;">        82:49:79:81:f6:4a:6e:4a:1c:01:c9:c2:3b:b8:c5:97:79:8b:</span></span>
<span class="line"><span style="color:#E2931D;">        e5:8c:ef:c2:44:9a:3e:4b:2e:de:97:64:15:7d:b9:44:c3:5c:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">        42:16:eb:ff:f9:34:ba:ba:53:ac:b0:10:93:ff:0f:b2:ba:96:</span></span>
<span class="line"><span style="color:#E2931D;">        7b:d3:75:58:10:ca:2f:7d:52:d5:5b:96:8b:18:35:d8:99:41:</span></span>
<span class="line"><span style="color:#E2931D;">        c6:fe:e1:9a:a6:58:df:2f:be:47:68:ea:ee:1b:af:bd:9c:94:</span></span>
<span class="line"><span style="color:#E2931D;">        58:ae:1a:4d:a1:a8:2d:ac:06:88:cd:ec:ce:b1:e8:98:d7:81:</span></span>
<span class="line"><span style="color:#E2931D;">        e5:9c:73:94:96:fd:d9:1b:cf:87:fd:01:af:55:10:8a:35:e5:</span></span>
<span class="line"><span style="color:#E2931D;">        7e:86:15:45:a8:b4:59:62:01:62:28:d1:34:9a:58:03:f0:7a:</span></span>
<span class="line"><span style="color:#E2931D;">        a6:3b:79:63:b5:eb:2a:ee:af:a4:4c:27:8e:e0:7d:4f:ec:c5:</span></span>
<span class="line"><span style="color:#E2931D;">        cf:26:a3:c4:f4:a1:4f:1d:39:f7:85:6e:34:68:73:ea:48:2a:</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">        3b:a0:de:80:d5:75:f9:dc:0e:70:63:4e:76:0f:90:b1:75:1a:</span></span>
<span class="line"><span style="color:#E2931D;">        88:0f:80:9c:50:a0:3c:9d:b0:84:36:98:ac:58:95:ff:fa:57:</span></span>
<span class="line"><span style="color:#E2931D;">        72:41:02:93:3d:23:bd:1f:fe:79:a8:b9:e4:e0:5a:36:af:14:</span></span>
<span class="line"><span style="color:#E2931D;">        42:f2:88:47:18:40:dc:e9:00:f1:8b:4f:84:19:b8:54:06:7b:</span></span>
<span class="line"><span style="color:#E2931D;">        dd:1f:2e:2d</span></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 申请证书并颁发证书</span></span>
<span class="line"><span style="color:#E2931D;">为需要使用证书的主机生成私钥</span></span>
<span class="line"><span style="color:#39ADB5;">(</span><span style="color:#6182B8;">umask</span><span style="color:#F76D47;"> 066</span><span style="color:#39ADB5;">;</span><span style="color:#E2931D;"> openssl</span><span style="color:#91B859;"> genrsa</span><span style="color:#91B859;"> -out</span><span style="color:#91B859;"> /data/test.key</span><span style="color:#F76D47;"> 2048</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">为需要使用证书的主机生成证书申请文件</span></span>
<span class="line"><span style="color:#E2931D;">openssl</span><span style="color:#91B859;"> req</span><span style="color:#91B859;"> -new</span><span style="color:#91B859;"> -key</span><span style="color:#91B859;"> /data/test.key</span><span style="color:#91B859;"> -out</span><span style="color:#91B859;"> /data/test.csr</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E2931D;">在CA签署证书并将证书颁发给请求者</span></span>
<span class="line"><span style="color:#E2931D;">openssl</span><span style="color:#91B859;"> ca</span><span style="color:#91B859;"> -in</span><span style="color:#91B859;"> /data/test.csr</span><span style="color:#91B859;"> -out</span><span style="color:#91B859;"> /etc/pki/CA/certs/test.crt</span><span style="color:#91B859;"> -days</span><span style="color:#F76D47;"> 100</span></span>
<span class="line"><span style="color:#E2931D;">注意：默认要求国家、省、公司名称必须一致</span></span>
<span class="line"><span style="color:#E2931D;">查看证书中的信息</span></span>
<span class="line"><span style="color:#E2931D;">openssl</span><span style="color:#91B859;"> x509</span><span style="color:#91B859;"> -in</span><span style="color:#91B859;"> /etc/pki/CA/cacert.pem</span><span style="color:#91B859;"> -noout</span><span style="color:#91B859;"> -text</span><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;">#查看指定编号的证书状态</span></span>
<span class="line"><span style="color:#E2931D;">openssl</span><span style="color:#91B859;"> ca</span><span style="color:#91B859;"> -status</span><span style="color:#91B859;"> SERIAL</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;"> </span></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 吊销证书</span></span>
<span class="line"><span style="color:#E2931D;">在客户端获取要吊销的证书serial</span></span>
<span class="line"><span style="color:#E2931D;">openssl</span><span style="color:#91B859;"> x509</span><span style="color:#91B859;"> -in</span><span style="color:#91B859;"> /etc/pki/CA/cacert.pem</span><span style="color:#91B859;"> -noout</span><span style="color:#91B859;"> -serial</span><span style="color:#91B859;"> -subject</span></span>
<span class="line"><span style="color:#E2931D;">在CA上，根据客户提交的serial与subject信息，对比校验是否与index.txt文件中的信息一致，吊销证书</span></span>
<span class="line"><span style="color:#E2931D;">openssl</span><span style="color:#91B859;"> ca</span><span style="color:#91B859;"> -revoke</span><span style="color:#91B859;"> /etc/pki/CA/newcerts/SERIAL.pem</span></span>
<span class="line"><span style="color:#E2931D;">指定第一个吊销证书的编号，注意：第一次更新吊销列表前，才需要执行</span></span>
<span class="line"><span style="color:#6182B8;">echo</span><span style="color:#F76D47;"> 01</span><span style="color:#39ADB5;"> &gt;</span><span style="color:#91B859;"> /etc/pki/CA/crlnumber</span></span>
<span class="line"><span style="color:#E2931D;">更新吊销证书列表</span></span>
<span class="line"><span style="color:#E2931D;">openssl</span><span style="color:#91B859;"> ca</span><span style="color:#91B859;"> -gencrl</span><span style="color:#91B859;"> -out</span><span style="color:#91B859;"> /etc/pki/CA/crl.pem</span></span>
<span class="line"><span style="color:#E2931D;">查看crl文件</span></span>
<span class="line"><span style="color:#E2931D;">openssl</span><span style="color:#91B859;"> crl</span><span style="color:#91B859;"> -in</span><span style="color:#91B859;"> /etc/pki/CA/crl.pem</span><span style="color:#91B859;"> -noout</span><span style="color:#91B859;"> -test</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br><span class="line-number">128</span><br><span class="line-number">129</span><br><span class="line-number">130</span><br><span class="line-number">131</span><br></div></div></details><h2 id="_19-总结openssh免密认证原理-及免认证实现过程。" tabindex="-1">19. 总结openssh免密认证原理，及免认证实现过程。 <a class="header-anchor" href="#_19-总结openssh免密认证原理-及免认证实现过程。" aria-label="Permalink to &quot;19. 总结openssh免密认证原理，及免认证实现过程。&quot;">​</a></h2><p>SSH的用户认证方式有两种<br> 第一种是账户密码登录，即你需要连接的远程服务器某一个用户与密码，比较常用，也比较简单。<br> 第二种是公钥验证授权登录，这一种认证较为复杂，但是配置好后其后续操作将十分便捷</p><p>原理：</p><p><img src="http://pic.justdoiit.top/imgs/2023-10-26-1698303373.webp" alt="" loading="lazy"></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#90A4AE;font-style:italic;"># 生成秘钥</span></span>
<span class="line"><span style="color:#E2931D;">ssh-keygen</span><span style="color:#91B859;"> -t</span><span style="color:#91B859;"> rsa</span><span style="color:#91B859;"> -C</span><span style="color:#39ADB5;"> &quot;</span><span style="color:#91B859;">your_email@gmail.com</span><span style="color:#39ADB5;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 将公钥id_rsa.pub同步至服务器（ip）地址的user用户下</span></span>
<span class="line"><span style="color:#E2931D;">ssh-copy-id</span><span style="color:#91B859;"> -i</span><span style="color:#91B859;"> ~/.ssh/id_rsa.pub</span><span style="color:#91B859;">  user@ip</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 查看可信任公钥列表里，存在你的公钥</span></span>
<span class="line"><span style="color:#6182B8;">cd</span><span style="color:#91B859;"> ~/.ssh/</span></span>
<span class="line"><span style="color:#E2931D;">cat</span><span style="color:#91B859;"> authorized_keys</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 免密登录</span></span>
<span class="line"><span style="color:#E2931D;">ssh</span><span style="color:#91B859;"> user@10.11.xx.xx</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div>`,106),o=[e];function c(r,t,i,y,b,A){return a(),n("div",null,o)}const B=s(p,[["render",c]]);export{m as __pageData,B as default};
