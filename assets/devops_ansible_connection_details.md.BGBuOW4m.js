import{_ as s,c as a,o as n,a4 as e}from"./chunks/framework.GYzjcnJh.js";const y=JSON.parse('{"title":"","description":"","frontmatter":{"date":"2024-03-07 11:36:22"},"headers":[],"relativePath":"devops/ansible/connection_details.md","filePath":"devops/ansible/connection_details.md"}'),l={name:"devops/ansible/connection_details.md"},p=e(`<h2 id="设置远程用户" tabindex="-1">设置远程用户 <a class="header-anchor" href="#设置远程用户" aria-label="Permalink to &quot;设置远程用户&quot;">​</a></h2><p>默认情况下，<code>Ansible</code> 使用您在控制节点上的用户名连接到所有远程设备。如果远程设备上不存在该用户名，您可以为连接设置不同的用户名</p><p><strong>playbook</strong></p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#E2931D;">---</span></span>
<span class="line"><span style="color:#39ADB5;">-</span><span style="color:#E53935;"> name</span><span style="color:#39ADB5;">:</span><span style="color:#91B859;"> update webservers</span></span>
<span class="line"><span style="color:#E53935;">  hosts</span><span style="color:#39ADB5;">:</span><span style="color:#91B859;"> webservers</span></span>
<span class="line"><span style="color:#E53935;">  remote_user</span><span style="color:#39ADB5;">:</span><span style="color:#91B859;"> admin</span></span>
<span class="line"></span>
<span class="line"><span style="color:#E53935;">  tasks</span><span style="color:#39ADB5;">:</span></span>
<span class="line"><span style="color:#39ADB5;">  -</span><span style="color:#E53935;"> name</span><span style="color:#39ADB5;">:</span><span style="color:#91B859;"> thing to do first in this playbook</span></span>
<span class="line"><span style="color:#91B859;">  . . .</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p><strong>inventory</strong></p><div class="language-yaml line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">yaml</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#91B859;">other1.example.com     ansible_connection=ssh        ansible_user=myuser</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div><h2 id="设置-ssh-密钥" tabindex="-1">设置 SSH 密钥 <a class="header-anchor" href="#设置-ssh-密钥" aria-label="Permalink to &quot;设置 SSH 密钥&quot;">​</a></h2><p>默认情况下，Ansible 假设您使用 SSH 密钥连接到远程计算机</p><p>如果需要，您可以通过 --ask-pass 选项使用密码身份验证。</p><p><strong>要设置 SSH 代理以避免重新输入密码</strong></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#E2931D;">ssh-agent</span><span style="color:#91B859;"> bash</span></span>
<span class="line"><span style="color:#E2931D;">ssh-add</span><span style="color:#91B859;"> ~/.ssh/id_rsa</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="针对本地主机运行" tabindex="-1">针对本地主机运行 <a class="header-anchor" href="#针对本地主机运行" aria-label="Permalink to &quot;针对本地主机运行&quot;">​</a></h2><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#E2931D;">ansible</span><span style="color:#91B859;"> localhost</span><span style="color:#91B859;"> -m</span><span style="color:#91B859;"> ping</span><span style="color:#91B859;"> -e</span><span style="color:#39ADB5;"> &#39;</span><span style="color:#91B859;">ansible_python_interpreter=&quot;/usr/bin/env python&quot;</span><span style="color:#39ADB5;">&#39;</span></span>
<span class="line"></span>
<span class="line"><span style="color:#90A4AE;font-style:italic;"># 将其添加到清单文件中来显式指定 localhost</span></span>
<span class="line"><span style="color:#E2931D;">localhost</span><span style="color:#91B859;"> ansible_connection=local</span><span style="color:#91B859;"> ansible_python_interpreter=</span><span style="color:#39ADB5;">&quot;</span><span style="color:#91B859;">/usr/bin/env python</span><span style="color:#39ADB5;">&quot;</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h2 id="管理主机密钥检查" tabindex="-1">管理主机密钥检查 <a class="header-anchor" href="#管理主机密钥检查" aria-label="Permalink to &quot;管理主机密钥检查&quot;">​</a></h2><p>Ansible 默认启用主机密钥检查。检查主机密钥可以防止服务器欺骗和中间人攻击</p><p>禁用此行为，可以通过编辑 <code>/etc/ansible/ansible.cfg</code> 或 <code>~/.ansible.cfg</code></p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#39ADB5;">[</span><span style="color:#90A4AE;">defaults</span><span style="color:#39ADB5;">]</span></span>
<span class="line"><span style="color:#E2931D;">host_key_checking</span><span style="color:#91B859;"> =</span><span style="color:#91B859;"> False</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><p>或者，可以通过 <code>ANSIBLE_HOST_KEY_CHECKING</code> 环境变量设置</p><div class="language-bash line-numbers-mode"><button title="Copy Code" class="copy"></button><span class="lang">bash</span><pre class="shiki material-theme-lighter vp-code" tabindex="0"><code><span class="line"><span style="color:#9C3EDA;">export</span><span style="color:#90A4AE;"> ANSIBLE_HOST_KEY_CHECKING</span><span style="color:#39ADB5;">=</span><span style="color:#90A4AE;">False</span></span></code></pre><div class="line-numbers-wrapper" aria-hidden="true"><span class="line-number">1</span><br></div></div>`,19),o=[p];function t(r,c,i,d,b,h){return n(),a("div",null,o)}const m=s(l,[["render",t]]);export{y as __pageData,m as default};
